<?xml version="1.0" encoding="UTF-8"?>
<RBProject version="2020r2" FormatVersion="2" MinIDEVersion="20070100">
<block type="Project" ID="0">
 <ProjectSavedInVers>2020.02</ProjectSavedInVers>
 <IDEVersion>20200200</IDEVersion>
 <MajorVersion>1</MajorVersion>
 <MinorVersion>0</MinorVersion>
 <SubVersion>0</SubVersion>
 <Release>0</Release>
 <NonRelease>0</NonRelease>
 <Region></Region>
 <ShortVersion></ShortVersion>
 <LongVersion></LongVersion>
 <InfoVersion></InfoVersion>
 <AutoIncVersion>1</AutoIncVersion>
 <DefaultViewID>0</DefaultViewID>
 <ProjectType>0</ProjectType>
 <DefaultLanguage>0</DefaultLanguage>
 <CurrentLanguage>0</CurrentLanguage>
 <DefaultEncoding>0</DefaultEncoding>
 <BuildFlags>18688</BuildFlags>
 <UseBuildsFolder>1</UseBuildsFolder>
 <WebApp>0</WebApp>
 <Icon>
 </Icon>
 <MacCreator></MacCreator>
 <BuildCarbonMachOName>ActiveRecord</BuildCarbonMachOName>
 <BundleIdentifier>com.strawberrysw.activerecord</BundleIdentifier>
 <WinMDICaption></WinMDICaption>
 <BuildWinName>ActiveRecord.exe</BuildWinName>
 <BuildWinMDI>0</BuildWinMDI>
 <BuildWinCompanyName>Tim Parnell</BuildWinCompanyName>
 <BuildWinProductName></BuildWinProductName>
 <BuildWinInternalName></BuildWinInternalName>
 <BuildWinFileDescription></BuildWinFileDescription>
 <UseGDIPlus>1</UseGDIPlus>
 <HiDPI>1</HiDPI>
 <DarkMode>1</DarkMode>
 <BuildLinuxX86Name>ActiveRecord</BuildLinuxX86Name>
 <DebuggerCommandLine></DebuggerCommandLine>
 <LinuxArchitecture>1</LinuxArchitecture>
 <MacArchitecture>1</MacArchitecture>
 <WindowsArchitecture>1</WindowsArchitecture>
 <OptimizationLevel>0</OptimizationLevel>
 <CopyWindowsRedist>0</CopyWindowsRedist>
 <WindowsVersions>{35138b9a-5d96-4fbd-8e2d-a2440225f93a}|{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}|{1f676c76-80e1-4239-95bb-83d0f6d0da78}|{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}</WindowsVersions>
 <WindowsRunAs>0</WindowsRunAs>
</block>
<block type="Module" ID="1972432888">
 <ObjName>TP_ActiveRecord</ObjName>
 <ObjContainerID>0</ObjContainerID>
 <IsClass>0</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Assert</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>799899647</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Assert(bCondition as boolean, sMessage as string = "")</SourceLine>
   <SourceLine>#if DebugBuild then</SourceLine>
   <SourceLine>if not bCondition then</SourceLine>
   <SourceLine>Raise new TP_ActiveRecord.AssertionFailedException(sMessage)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>bCondition as boolean, sMessage as string = ""</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1179457535</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>//Use BeginTransaction when outside of ActiveRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = ctx.ConnectionAdapter_Get(GetTypeInfo(TP_ActiveRecord.Base))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.BeginTransaction</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ColumnName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1065863167</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ColumnName(rs as RowSet) As String</SourceLine>
   <SourceLine>Var iIndex As Integer = -1</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>For i As Integer = 0 To rs.ColumnCount-1</SourceLine>
   <SourceLine>Select Case rs.columnat(i).Name</SourceLine>
   <SourceLine>case "ColumnName"</SourceLine>
   <SourceLine>iIndex = i</SourceLine>
   <SourceLine>End Select</SourceLine>
   <SourceLine>Next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if iIndex &gt; -1 then</SourceLine>
   <SourceLine>Return rs.columnat(iIndex).StringValue</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Return "unknown"</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>576137215</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>//Use CommitTransaction when outside of ActiveRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = ctx.ConnectionAdapter_Get(GetTypeInfo(TP_ActiveRecord.Base))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.CommitTransaction</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Connect</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1463355391</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Connect(db as Database)</SourceLine>
   <SourceLine>Connect(GetTypeInfo(TP_ActiveRecord.Base), db)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>db as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Connect</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1319084031</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Connect(ty as Introspection.TypeInfo, db as Database)</SourceLine>
   <SourceLine>if ty=nil or db=nil then</SourceLine>
   <SourceLine>raise new NilObjectException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>adp = CreateDatabaseAdapter(db)</SourceLine>
   <SourceLine>GetContext.ConnectionAdapter_Set(ty, adp)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, db as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CreateDatabaseAdapter</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>406300671</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function CreateDatabaseAdapter(db as Database) As TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>if db isa SQLiteDatabase then</SourceLine>
   <SourceLine>return new SQLiteDatabaseAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>if db isa CubeSQLServer then</SourceLine>
   <SourceLine>return new cubeSQLDatabaseAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer</SourceLine>
   <SourceLine>if db isa MSSQLServerDatabase then</SourceLine>
   <SourceLine>return new MSSQLServerAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>if db isa MySQLCommunityServer then</SourceLine>
   <SourceLine>return new MySQLCommunityServerAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC</SourceLine>
   <SourceLine>if db isa ODBCDatabase then</SourceLine>
   <SourceLine>return new ODBCServerAdapter(db)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase</SourceLine>
   <SourceLine>if db isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>return new PostgreSQLDatabaseAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>if db isa VSQLiteDatabase then</SourceLine>
   <SourceLine>return new VSQLiteDatabaseAdapter(db)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ex as new UnsupportedOperationException</SourceLine>
   <SourceLine>ex.Message = "Unsupported database type: " + Introspection.GetType(db).FullName</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>db as Database</ItemParams>
  <ItemResult>TP_ActiveRecord.DatabaseAdapter</ItemResult>
 </Method>
 <Method>
  <ItemName>Disconnect</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>532191231</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Disconnect()</SourceLine>
   <SourceLine>'Disconnect the base active record class from the database</SourceLine>
   <SourceLine>Disconnect( GetTypeInfo(TP_ActiveRecord.Base) )</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Disconnect</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>945876991</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Disconnect(ty as Introspection.TypeInfo)</SourceLine>
   <SourceLine>'Disconnect a specific active record class from the database</SourceLine>
   <SourceLine>if ty=nil then</SourceLine>
   <SourceLine>raise new NilObjectException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>ctx.ConnectionAdapter_Remove(ty)</SourceLine>
   <SourceLine>#if RBVersion &gt;= 2011.04</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>if ctx.ConnectionAdapter_Count=0 then</SourceLine>
   <SourceLine>'kill the context</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(csCtx)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>m_dictContext.Remove(Session.Identifier)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Field</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>181069823</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Field(sFieldName as string) As TP_ActiveRecord.FieldOpt</SourceLine>
   <SourceLine>return new FieldOpt(sFieldName)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sFieldName as string</ItemParams>
  <ItemResult>TP_ActiveRecord.FieldOpt</ItemResult>
 </Method>
 <Method>
  <ItemName>FieldType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1553625087</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function FieldType(rs as RowSet) As Integer</SourceLine>
   <SourceLine>Var iIndex as integer = -1</SourceLine>
   <SourceLine>For i As Integer = 0 To rs.ColumnCount-1</SourceLine>
   <SourceLine>Select Case rs.ColumnAt(i).Name</SourceLine>
   <SourceLine>case "FieldType"</SourceLine>
   <SourceLine>iIndex = i</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if iIndex &gt; -1 then</SourceLine>
   <SourceLine>Return rs.ColumnAt(iIndex).IntegerValue</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Return 0</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <Method>
  <ItemName>Field_IsPrimary</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1504544767</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Field_IsPrimary(rs as RowSet) As Boolean</SourceLine>
   <SourceLine>For i As Integer = 0 To rs.ColumnCount-1</SourceLine>
   <SourceLine>Select Case rs.ColumnAt(i).Name</SourceLine>
   <SourceLine>case "IsPrimary"</SourceLine>
   <SourceLine>Return rs.ColumnAt(i).BooleanValue</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Return false</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>FindFieldProperty</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2012340223</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function FindFieldProperty(tyClass as Introspection.TypeInfo, sField as string) As Introspection.PropertyInfo</SourceLine>
   <SourceLine>Var iPrefixType as integer = 0 //Override to do prefixes and suffixes</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>static arsAllowPrefix() as string //= Array(^2) //Override for your own prefixes</SourceLine>
   <SourceLine>static arsAllowSuffix() as string //= Array(^3) //Override for your own suffixes</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Match the field to a property of the class.</SourceLine>
   <SourceLine>select case iPrefixType</SourceLine>
   <SourceLine>case 0</SourceLine>
   <SourceLine>// No prefix / suffix</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each pi as Introspection.PropertyInfo in tyClass.GetProperties</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if pi.Name = sField then</SourceLine>
   <SourceLine>return pi 'accept exact match</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case 1</SourceLine>
   <SourceLine>// Prefix</SourceLine>
   <SourceLine>for each pi as Introspection.PropertyInfo in tyClass.GetProperties</SourceLine>
   <SourceLine>if pi.Name.Right(sField.Length) = sField then</SourceLine>
   <SourceLine>'check for a prefix match</SourceLine>
   <SourceLine>Var sPrefix as string = pi.Name.Middle(0, pi.Name.Length - sField.Length)</SourceLine>
   <SourceLine>if arsAllowPrefix.IndexOf(sPrefix) &gt;-1 then</SourceLine>
   <SourceLine>return pi</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case 2</SourceLine>
   <SourceLine>// Suffix</SourceLine>
   <SourceLine>for each pi as Introspection.PropertyInfo in tyClass.GetProperties</SourceLine>
   <SourceLine>if pi.name.left(sField.Length) = sField then</SourceLine>
   <SourceLine>'Check for suffix match</SourceLine>
   <SourceLine>Var sSuffix as string = pi.Name.Right(pi.Name.Length - sField.Length)</SourceLine>
   <SourceLine>if arsAllowSuffix.IndexOf(sSuffix) &gt; -1 then</SourceLine>
   <SourceLine>return pi</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo, sField as string</ItemParams>
  <ItemResult>Introspection.PropertyInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>FindMatchingTable</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1867589631</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function FindMatchingTable(adp as TP_ActiveRecord.DatabaseAdapter, sClassName as string) As string</SourceLine>
   <SourceLine>Var sTable as string = sClassName</SourceLine>
   <SourceLine>if adp.HasTable( sTable ) then</SourceLine>
   <SourceLine>return sTable</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sTable = "tbl" + sClassName</SourceLine>
   <SourceLine>if adp.HasTable( sTable ) then</SourceLine>
   <SourceLine>return sTable</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'if the class is clsSomething, look for Something and tblSomething</SourceLine>
   <SourceLine>'but not if the letter after cls is lowercase</SourceLine>
   <SourceLine>Var sFourth As String = sClassName.Middle(4,1)</SourceLine>
   <SourceLine>if sClassName.left( 3 ) = "cls" and _</SourceLine>
   <SourceLine>sFourth.Compare( "A", ComparisonOptions.CaseInsensitive ) &gt;= -1 And _</SourceLine>
   <SourceLine>sFourth.Compare( "Z", ComparisonOptions.CaseInsensitive ) &lt;= -1 Then</SourceLine>
   <SourceLine>sTable = sClassName.Middle(3)</SourceLine>
   <SourceLine>if adp.HasTable( sTable ) then</SourceLine>
   <SourceLine>return sTable</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sTable = "tbl" + sTable</SourceLine>
   <SourceLine>if adp.HasTable( sTable ) then</SourceLine>
   <SourceLine>return sTable</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return ""</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>adp as TP_ActiveRecord.DatabaseAdapter, sClassName as string</ItemParams>
  <ItemResult>string</ItemResult>
 </Method>
 <Method>
  <ItemName>GetContext</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2130739199</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetContext() As TP_ActiveRecord.P.Context</SourceLine>
   <SourceLine>if m_ctxDefault is nil then</SourceLine>
   <SourceLine>m_ctxDefault = new TP_ActiveRecord.P.Context</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if RBVersion &gt;= 2011.04 then</SourceLine>
   <SourceLine>#if TargetWeb then</SourceLine>
   <SourceLine>#if XojoVersion &lt; 2020 then</SourceLine>
   <SourceLine>if Session &lt;&gt; nil then</SourceLine>
   <SourceLine>return m_ctxDefault</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>if Session = nil then</SourceLine>
   <SourceLine>return m_ctxDefault</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(csCtx)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_dictContext=nil then</SourceLine>
   <SourceLine>m_dictContext = new Dictionary</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if not m_dictContext.HasKey(Session.Identifier) then</SourceLine>
   <SourceLine>m_dictContext.Value(Session.Identifier) = new TP_ActiveRecord.P.Context</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>return m_dictContext.Value(Session.Identifier)</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return m_ctxDefault</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.P.Context</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabaseAdapter</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2137098239</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabaseAdapter() As TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>//GetDatabaseAdapter</SourceLine>
   <SourceLine>//Useful if you want to get do transactions outside of the Base Class.</SourceLine>
   <SourceLine>//Example:  You know you have some lengthy operations to do.</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = ctx.ConnectionAdapter_Get(GetTypeInfo(TP_ActiveRecord.Base))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Return adp</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.DatabaseAdapter</ItemResult>
 </Method>
 <Method>
  <ItemName>GetTableDefs</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>900749311</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetTableDefs() As TP_ActiveRecord.TableDef()</SourceLine>
   <SourceLine>Var aroTableDef() as TP_ActiveRecord.TableDef</SourceLine>
   <SourceLine>for each oTableInfo as TP_ActiveRecord.P.TableInfo in GetContext.TableInfo_List</SourceLine>
   <SourceLine>Var aro() as TP_ActiveRecord.FieldDef</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldInfo as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>Var o as new TP_ActiveRecord.FieldDef( oFieldInfo.sFieldName, oFieldInfo.enFieldType, oFieldInfo.bPrimaryKey, oFieldInfo.bForeignKey)</SourceLine>
   <SourceLine>aro.Add(o)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oTableDef as new TP_ActiveRecord.TableDef(oTableInfo.sTableName, oTableInfo.sPrimaryKey, aro)</SourceLine>
   <SourceLine>aroTableDef.Add(oTableDef)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>return aroTableDef</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.TableDef()</ItemResult>
 </Method>
 <Method>
  <ItemName>GetTableInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>69824511</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetTableInfo(ty as Introspection.TypeInfo) As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>'check the info cache and return the mapping if it exists</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo = GetContext.TableInfo_Get(ty)</SourceLine>
   <SourceLine>if oTableInfo&lt;&gt;nil then</SourceLine>
   <SourceLine>return oTableInfo</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'try to map the class to a table by name</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = GetContext.ConnectionAdapter_Get( ty )</SourceLine>
   <SourceLine>if adp&lt;&gt;nil then</SourceLine>
   <SourceLine>Var sTable as string</SourceLine>
   <SourceLine>sTable = FindMatchingTable( adp, ty.Name )</SourceLine>
   <SourceLine>if sTable&lt;&gt;"" then</SourceLine>
   <SourceLine>Table adp.Db, sTable, ty</SourceLine>
   <SourceLine>return GetContext.TableInfo_Get(ty)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'table not registered and not found by name</SourceLine>
   <SourceLine>Var ex as RuntimeException</SourceLine>
   <SourceLine>ex.Message = "Class does not have a table registered for it: " + ty.FullName</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo</ItemParams>
  <ItemResult>TP_ActiveRecord.P.TableInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>GetTypeConstructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1943277567</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetTypeConstructor(oTableInfo as TP_ActiveRecord.P.TableInfo) As Introspection.ConstructorInfo</SourceLine>
   <SourceLine>Var oConstructor as Introspection.ConstructorInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each o as Introspection.ConstructorInfo in oTableInfo.tyClass.GetConstructors</SourceLine>
   <SourceLine>Var aroParam() as Introspection.ParameterInfo = o.GetParameters</SourceLine>
   <SourceLine>if aroParam.LastIndex = 0 then</SourceLine>
   <SourceLine>if aroParam(0).ParameterType.FullName = "RowSet" then</SourceLine>
   <SourceLine>oConstructor = o</SourceLine>
   <SourceLine>exit for</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oConstructor</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oTableInfo as TP_ActiveRecord.P.TableInfo</ItemParams>
  <ItemResult>Introspection.ConstructorInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>MapFieldInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>787466239</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function MapFieldInfo(tyClass as Introspection.TypeInfo, rs as RowSet, aroFieldOpt() as FieldOpt) As TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>' static arsAllowPrefix() as string = Array("m_", "m_id","i","s","dtm","dt","b","d","v","pict")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sField as string = ColumnName(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'extract the field option if one was passed in for this field</SourceLine>
   <SourceLine>Var oFieldOpt as FieldOpt</SourceLine>
   <SourceLine>for each o as FieldOpt in aroFieldOpt</SourceLine>
   <SourceLine>if o.FieldName=sField then</SourceLine>
   <SourceLine>oFieldOpt = o</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oFieldOpt&lt;&gt;nil and oFieldOpt.IsIgnored then</SourceLine>
   <SourceLine>return nil 'ignore this field</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Find the database field type</SourceLine>
   <SourceLine>var enFieldType as DBType</SourceLine>
   <SourceLine>var iFieldType as integer = FieldType(rs)</SourceLine>
   <SourceLine>select case iFieldType</SourceLine>
   <SourceLine>case 1 // MSSQL bit</SourceLine>
   <SourceLine>enFieldType = DBType.DBoolean</SourceLine>
   <SourceLine>case 2 'smallint</SourceLine>
   <SourceLine>enFieldType = DBType.DSmallInt</SourceLine>
   <SourceLine>case 3 'integer</SourceLine>
   <SourceLine>enFieldType = DBType.DInteger</SourceLine>
   <SourceLine>case 4 'Serial</SourceLine>
   <SourceLine>enFieldType = DBType.DText</SourceLine>
   <SourceLine>case 5 'text or varchar</SourceLine>
   <SourceLine>enFieldType = DBType.DText</SourceLine>
   <SourceLine>case 6 'float</SourceLine>
   <SourceLine>enFieldType = DBType.DFloat</SourceLine>
   <SourceLine>case 7 'double</SourceLine>
   <SourceLine>enFieldType = DBType.DDouble</SourceLine>
   <SourceLine>case 8 'date</SourceLine>
   <SourceLine>enFieldType = DBType.DDate</SourceLine>
   <SourceLine>case 9 'time</SourceLine>
   <SourceLine>enFieldType = DBType.DTime</SourceLine>
   <SourceLine>case 10 'timestamp</SourceLine>
   <SourceLine>enFieldType = DBType.DTimestamp</SourceLine>
   <SourceLine>case 11 'currency</SourceLine>
   <SourceLine>enFieldType = DBType.DCurrency</SourceLine>
   <SourceLine>case 12 'boolean</SourceLine>
   <SourceLine>enFieldType = DBType.DBoolean</SourceLine>
   <SourceLine>case 13 'Decimal</SourceLine>
   <SourceLine>enFieldType = DBType.DDecimal</SourceLine>
   <SourceLine>case 14 'binary</SourceLine>
   <SourceLine>enFieldType = DBType.DBlob</SourceLine>
   <SourceLine>case 15 'blob</SourceLine>
   <SourceLine>enFieldType = DBType.DBlob</SourceLine>
   <SourceLine>case 16 'varbinary</SourceLine>
   <SourceLine>enFieldType = DBType.DBlob</SourceLine>
   <SourceLine>case 18 'String</SourceLine>
   <SourceLine>enFieldType = DBType.DText</SourceLine>
   <SourceLine>case 19 'int64</SourceLine>
   <SourceLine>enFieldType = DBType.DInt64</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Match the field to a property of the class.</SourceLine>
   <SourceLine>' Properties are named with a prefix:  &lt;prefix&gt;FieldName = FieldName</SourceLine>
   <SourceLine>var piFound as Introspection.PropertyInfo</SourceLine>
   <SourceLine>piFound = FindFieldProperty(tyClass, sField)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if piFound=nil then</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert( false, "No property for field " +tyclass.FullName + "." + sField )</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oFieldInfo as new TP_ActiveRecord.P.FieldInfo(sField, piFound, tyClass)</SourceLine>
   <SourceLine>oFieldInfo.enFieldType = enFieldType</SourceLine>
   <SourceLine>if Field_IsPrimary(rs) then</SourceLine>
   <SourceLine>oFieldInfo.bPrimaryKey = true</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Foreign Key Support</SourceLine>
   <SourceLine>var oFieldProp as Introspection.PropertyInfo = FindFieldProperty(tyClass, sField)</SourceLine>
   <SourceLine>if oFieldProp &lt;&gt; nil then</SourceLine>
   <SourceLine>var aroAttributes() as Introspection.AttributeInfo = oFieldProp.GetAttributes</SourceLine>
   <SourceLine>for each oAttrib as Introspection.AttributeInfo in aroAttributes</SourceLine>
   <SourceLine>if oAttrib.Name = "ForeignKey" then</SourceLine>
   <SourceLine>oFieldInfo.bForeignKey = (oAttrib.Value = "True")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next oAttrib</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oFieldInfo</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo, rs as RowSet, aroFieldOpt() as FieldOpt</ItemParams>
  <ItemResult>TP_ActiveRecord.P.FieldInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>MapTableInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1991741439</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function MapTableInfo(db as Database, sTable as string, tyClass as Introspection.TypeInfo, aroFieldOpt() as FieldOpt, IsView as boolean = false) As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>'Map fields in the database to properties on the class and</SourceLine>
   <SourceLine>'return a list of &lt;field&gt; : &lt;propertyInfo&gt; pairs.</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var oTableInfo as new TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo.tyClass = tyClass</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var rs as RowSet</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase then</SourceLine>
   <SourceLine>'Database.FieldSchema does not work with PostgreSQL Views.</SourceLine>
   <SourceLine>'It does not return field info.</SourceLine>
   <SourceLine>'So we cast db to PostgreSQLDatabase</SourceLine>
   <SourceLine>if db isa PostgreSQLDatabase and IsView = true then</SourceLine>
   <SourceLine>var dbPostGresSQL as PostgreSQLDatabase = PostgreSQLDatabase(db)</SourceLine>
   <SourceLine>rs = dbPostGresSQL.TableColumns(sTable)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>rs = Db.TableColumns(sTable)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#elseif TP_ActiveRecord.kConfigUseMSSQLServerMBS then</SourceLine>
   <SourceLine>' mbs does not support or implement FIELDSCHEMA</SourceLine>
   <SourceLine>if db isa SQLDatabaseMBS then</SourceLine>
   <SourceLine>var mbs_db as SQLDatabaseMBS = SQLDatabaseMBS(db)</SourceLine>
   <SourceLine>' since mbs can support many different dbs through this ssame set up </SourceLine>
   <SourceLine>' we need to see which we have to know how to get the right filed schema query</SourceLine>
   <SourceLine>if mbs_db.ServerVersionString.Left(20) = "Microsoft SQL Server" then</SourceLine>
   <SourceLine>var stmt as SQLPreparedStatementMBS = mbs_db.Prepare(TP_ActiveRecord.MSSQLServerAdapterMBS.kFieldSchema)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = stmt.SQLSelect(sTable, sTable, sTable)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>// Not a PostgreSQL database, so we don't need to workaround a Xojo bug</SourceLine>
   <SourceLine>rs = Db.TableColumns(sTable)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>TP_ActiveRecord.Assert(rs.AfterLastRow=false, "Table not found: " + sTable)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>do until rs.AfterLastRow</SourceLine>
   <SourceLine>Var oFieldInfo as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>oFieldInfo = MapFieldInfo(tyClass, rs, aroFieldOpt)</SourceLine>
   <SourceLine>if oFieldInfo&lt;&gt;nil then</SourceLine>
   <SourceLine>if oFieldInfo.bPrimaryKey then</SourceLine>
   <SourceLine>oTableInfo.sPrimaryKey = oFieldInfo.sFieldName</SourceLine>
   <SourceLine>oTableInfo.piPrimaryKey = oFieldInfo.piFieldProperty</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>oTableInfo.aroField.Add(oFieldInfo)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine>loop</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if IsView = false then</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert(oTableInfo.sPrimaryKey&lt;&gt;"", "The table needs to have a primary key")</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo.sTableName = sTable</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oTableInfo</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>db as Database, sTable as string, tyClass as Introspection.TypeInfo, aroFieldOpt() as FieldOpt, IsView as boolean = false</ItemParams>
  <ItemResult>TP_ActiveRecord.P.TableInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>MapTableInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1072328703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function MapTableInfo(tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef) As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>'Map fields in the database to properties on the class and</SourceLine>
   <SourceLine>'return a list of &lt;field&gt; : &lt;propertyInfo&gt; pairs.</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>' Var pi as Introspection.Propertyinfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = new TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo.sTableName = oTableDef.sTableName</SourceLine>
   <SourceLine>oTableInfo.sPrimaryKey = oTableDef.sPrimaryKey</SourceLine>
   <SourceLine>oTableInfo.piPrimaryKey = FindFieldProperty(tyClass, oTableInfo.sPrimaryKey)</SourceLine>
   <SourceLine>if oTableInfo.piPrimaryKey=nil then</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>oTableInfo.tyClass = tyClass</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldDef as TP_ActiveRecord.FieldDef in oTableDef.aroField</SourceLine>
   <SourceLine>Var oFieldInfo as new TP_ActiveRecord.P.FieldInfo(oFieldDef.sFieldName, FindFieldProperty(tyClass, oFieldDef.sFieldName), tyClass)</SourceLine>
   <SourceLine>oFieldInfo.bPrimaryKey = oFieldDef.IsPrimaryKey</SourceLine>
   <SourceLine>oFieldInfo.bForeignKey = oFieldDef.IsForeignKey</SourceLine>
   <SourceLine>oFieldInfo.enFieldType = oFieldDef.enFieldType</SourceLine>
   <SourceLine>if oFieldInfo.piFieldProperty=nil then</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>oTableInfo.aroField.Add(oFieldInfo)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oTableInfo</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef</ItemParams>
  <ItemResult>TP_ActiveRecord.P.TableInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>Query</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2087897087</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Query(ty as Introspection.TypeInfo, sCriteria as string = "", sOrder as string = "") As Variant()</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>adp = GetContext.ConnectionAdapter_Get( ty )</SourceLine>
   <SourceLine>if adp=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if not ty.IsSubclassOf( GetTypeInfo( Base ) ) then</SourceLine>
   <SourceLine>Var ex as new RuntimeException</SourceLine>
   <SourceLine>ex.Message = "Invalid type"</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aro() as Variant</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo = GetTableInfo( ty )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oConstructor as Introspection.ConstructorInfo</SourceLine>
   <SourceLine>oConstructor = GetTypeConstructor(oTableInfo)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>rs = adp.SelectList(oTableInfo.sTableName, sCriteria, sOrder)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>do until rs.AfterLastRow</SourceLine>
   <SourceLine>Var arv() as Variant</SourceLine>
   <SourceLine>arv.Add(rs)</SourceLine>
   <SourceLine>Var oBase as Base = oConstructor.Invoke(arv)</SourceLine>
   <SourceLine>aro.Add( oBase )</SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine>loop</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return aro</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, sCriteria as string = "", sOrder as string = ""</ItemParams>
  <ItemResult>Variant()</ItemResult>
 </Method>
 <Method>
  <ItemName>QueryRecordset</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1882695679</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function QueryRecordset(ty as Introspection.TypeInfo, sql as String) As RowSet</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>adp = GetContext.ConnectionAdapter_Get( ty )</SourceLine>
   <SourceLine>if adp=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if not ty.IsSubclassOf( GetTypeInfo( Base ) ) then</SourceLine>
   <SourceLine>Var ex as new RuntimeException</SourceLine>
   <SourceLine>ex.Message = "Invalid type"</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return adp.SQLSelect(sql)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, sql as String</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1357592575</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>//Use RollbackTransaction when outside of ActiveRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = ctx.ConnectionAdapter_Get(GetTypeInfo(TP_ActiveRecord.Base))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.RollbackTransaction</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>stringFromDBType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>448464895</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function stringFromDBType(enDBType as TP_ActiveRecord.DBType) As string</SourceLine>
   <SourceLine>select case enDBType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>return "DInteger"</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>return "DSmallInt"</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>return "DDouble"</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>return "DDate"</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>return "DTime"</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>return "DTimestamp"</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>return "DBoolean"</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>return "DBlob"</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>return "DText"</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>return "DInt64"</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>return "DFloat"</SourceLine>
   <SourceLine>case DBtype.DCurrency</SourceLine>
   <SourceLine>return "DCurrency"</SourceLine>
   <SourceLine>case DBType.DDecimal</SourceLine>
   <SourceLine>Return "DDecimal"</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>enDBType as TP_ActiveRecord.DBType</ItemParams>
  <ItemResult>string</ItemResult>
 </Method>
 <Method>
  <ItemName>Table</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1766694911</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Table(db as Database, sTable as string, tyClass as Introspection.TypeInfo, ParamArray aroFieldOpt() as FieldOpt)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Record the mapping between the type and the table.</SourceLine>
   <SourceLine>oTableInfo = TP_ActiveRecord.MapTableInfo( db, sTable, tyClass, aroFieldOpt )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>GetContext.TableInfo_Set(tyClass, oTableInfo)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>db as Database, sTable as string, tyClass as Introspection.TypeInfo, ParamArray aroFieldOpt() as FieldOpt</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Table</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>989872127</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Table(tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Record the mapping between the type and the table.</SourceLine>
   <SourceLine>oTableInfo = TP_ActiveRecord.MapTableInfo(tyClass, oTableDef)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>GetContext.TableInfo_Set(tyClass, oTableInfo)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>VerifyClass</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1223100415</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub VerifyClass(tyClass as Introspection.TypeInfo)</SourceLine>
   <SourceLine>// Verify that all the fields marked as DatabaseField</SourceLine>
   <SourceLine>// are on the table, assert an exception if not.</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Collect all of the known table fields into an array</SourceLine>
   <SourceLine>Var arsDBFields() as String</SourceLine>
   <SourceLine>Var oInfo as TP_ActiveRecord.P.TableInfo = GetTableInfo(tyClass)</SourceLine>
   <SourceLine>for i as Integer = 0 to oInfo.aroField.LastIndex</SourceLine>
   <SourceLine>arsDBFields.Add(oInfo.aroField(i).sFieldName)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Iterate the properties</SourceLine>
   <SourceLine>Var aroProperties() as Introspection.PropertyInfo = tyClass.GetProperties</SourceLine>
   <SourceLine>for each oProp as Introspection.PropertyInfo in aroProperties</SourceLine>
   <SourceLine>// Get the property attribtues</SourceLine>
   <SourceLine>Var aroAttributes() as Introspection.AttributeInfo = oProp.GetAttributes</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Look for the DatabaseField flag</SourceLine>
   <SourceLine>Var bFlaggedAsDBField as Boolean</SourceLine>
   <SourceLine>for each oAttrib as Introspection.AttributeInfo in aroAttributes</SourceLine>
   <SourceLine>if oAttrib.Name = "DatabaseField" then</SourceLine>
   <SourceLine>bFlaggedAsDBField = (oAttrib.Value = "True")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next oAttrib</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// If flag was not found, do not process this property</SourceLine>
   <SourceLine>if bFlaggedAsDBField = false then continue for oProp</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Iterate the tables to see if they're within this property name</SourceLine>
   <SourceLine>// i.e. the lazy way to check ignoring prefix or suffix settings</SourceLine>
   <SourceLine>Var bPropIsField as Boolean</SourceLine>
   <SourceLine>for each sField as String in arsDBFields</SourceLine>
   <SourceLine>if VerifyClassProperty(oProp.Name, sField) = true then</SourceLine>
   <SourceLine>// Field was found</SourceLine>
   <SourceLine>bPropIsField = true</SourceLine>
   <SourceLine>exit for sField</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next sField</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>TP_ActiveRecord.Assert(bPropIsField, "Database column for property " + _</SourceLine>
   <SourceLine>tyClass.FullName + "." + oProp.Name + " could not be Found.")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next oProp</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>VerifyClassProperty</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>260276223</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function VerifyClassProperty(sProp as String, sField as String) As Boolean</SourceLine>
   <SourceLine>Var iPrefixType as integer = 0 //Override to do prefixes and suffixes</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>static arsAllowPrefix() as string //= Array(^2) //Override for your own prefixes</SourceLine>
   <SourceLine>static arsAllowSuffix() as string //= Array(^3) //Override for your own suffixes</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Match the field to a property of the class.</SourceLine>
   <SourceLine>select case iPrefixType</SourceLine>
   <SourceLine>case 0</SourceLine>
   <SourceLine>// No prefix / suffix</SourceLine>
   <SourceLine>return (sProp = sField)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case 1</SourceLine>
   <SourceLine>// Prefix</SourceLine>
   <SourceLine>for each sPrefix as String in arsAllowPrefix</SourceLine>
   <SourceLine>if sProp = sPrefix + sField then</SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next sPrefix</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case 2</SourceLine>
   <SourceLine>// Suffix</SourceLine>
   <SourceLine>for each sSuffix as String in arsAllowSuffix</SourceLine>
   <SourceLine>if sProp = sField + sSuffix then</SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next sSuffix</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sProp as String, sField as String</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>View</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2138935295</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub View(db as Database, sTable as string, tyClass as Introspection.TypeInfo, ParamArray aroFieldOpt() as FieldOpt)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Record the mapping between the type and the table.</SourceLine>
   <SourceLine>oTableInfo = TP_ActiveRecord.MapTableInfo( db, sTable, tyClass, aroFieldOpt, true )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>GetContext.TableInfo_Set(tyClass, oTableInfo)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>db as Database, sTable as string, tyClass as Introspection.TypeInfo, ParamArray aroFieldOpt() as FieldOpt</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>View</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>297555967</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub View(tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Record the mapping between the type and the table.</SourceLine>
   <SourceLine>oTableInfo = TP_ActiveRecord.MapTableInfo(tyClass, oTableDef)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>GetContext.TableInfo_Set(tyClass, oTableInfo)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tyClass as Introspection.TypeInfo, oTableDef as TP_ActiveRecord.TableDef</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Note>
  <ItemName>License</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>51826687</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <NoteLine>License</NoteLine>
   <NoteLine> Copyright 2011 - 2020, BKeeney Software, Inc.</NoteLine>
   <NoteLine> Copyright 2020, Tim Parnell</NoteLine>
   <NoteLine>&#32;</NoteLine>
   <NoteLine> MIT License</NoteLine>
   <NoteLine>&#32;</NoteLine>
   <NoteLine> Permission is hereby granted, free of charge, to any person obtaining a copy</NoteLine>
   <NoteLine> of this software and associated documentation files (the "Software"), to deal</NoteLine>
   <NoteLine> in the Software without restriction, including without limitation the rights</NoteLine>
   <NoteLine> to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</NoteLine>
   <NoteLine> copies of the Software, and to permit persons to whom the Software is</NoteLine>
   <NoteLine> furnished to do so, subject to the following conditions:</NoteLine>
   <NoteLine>&#32;</NoteLine>
   <NoteLine> The above copyright notice and this permission notice shall be included in</NoteLine>
   <NoteLine> all copies or substantial portions of the Software.</NoteLine>
   <NoteLine>&#32;</NoteLine>
   <NoteLine> THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</NoteLine>
   <NoteLine> IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</NoteLine>
   <NoteLine> FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</NoteLine>
   <NoteLine> AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</NoteLine>
   <NoteLine> LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</NoteLine>
   <NoteLine> OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</NoteLine>
   <NoteLine> THE SOFTWARE.</NoteLine>
   <NoteLine></NoteLine>
  </ItemSource>
  <ItemFlags>0</ItemFlags>
 </Note>
 <Note>
  <ItemName>Version History</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1438406655</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <NoteLine>Version History</NoteLine>
   <NoteLine>[2021.01] - April 2, 2021</NoteLine>
   <NoteLine> Fixed:</NoteLine>
   <NoteLine>   - API 2.0 Postgres adapter array issue</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2020.05] - December 9, 2020</NoteLine>
   <NoteLine> Changed:</NoteLine>
   <NoteLine>   - API 2.1 naming (removes 2020r1 support)</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2020.04] - October 8, 2020</NoteLine>
   <NoteLine> Fixed:</NoteLine>
   <NoteLine>   - Date-only changes are now recognized</NoteLine>
   <NoteLine>   - IsRecordModified no longer has redundant cases</NoteLine>
   <NoteLine>   - GUID now returns the string version of the ID when not a string</NoteLine>
   <NoteLine>   - API 2.0 library foreign key identification</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2020.03] - August 10, 2020</NoteLine>
   <NoteLine> Fixed:</NoteLine>
   <NoteLine>   - API 2.0 BindValues function</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2020.02] - August 4, 2020</NoteLine>
   <NoteLine> New:</NoteLine>
   <NoteLine>  - MBS SQL DatabaseAdapter for Microsoft SQL Server</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>Fixed:</NoteLine>
   <NoteLine>  - MySQL null saving</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>Changed:</NoteLine>
   <NoteLine>  - Adds support for multiple MSSQL FieldSchema types</NoteLine>
   <NoteLine>  - Desktop now uses connection pooling for threading support</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2020.01] - June 2020</NoteLine>
   <NoteLine> New:</NoteLine>
   <NoteLine>  - API 2.0 support</NoteLine>
   <NoteLine>  - Multiple database connections in one project</NoteLine>
   <NoteLine>  - Database field flagging with support from Propery Attributes</NoteLine>
   <NoteLine>    ↳ Set a property attribute named IsDatabaseField = True on database field properties</NoteLine>
   <NoteLine>  - Foreign key flagging with support from Property Attributes</NoteLine>
   <NoteLine>    ↳ Set a property attribute named IsForeignKey = True on foreign key field properties</NoteLine>
   <NoteLine>  - Saving a nil foreign key will INSERT / UPDATE a NULL for the record</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine> Changed:</NoteLine>
   <NoteLine>  - Rebranded library name</NoteLine>
   <NoteLine>  - Fixed all warnings in the TP_ActiveRecord module</NoteLine>
   <NoteLine>  - Consolidated multiple modules in to TP_ActiveRecord</NoteLine>
   <NoteLine>&#32;</NoteLine>
   <NoteLine> Removed:</NoteLine>
   <NoteLine>  - REALSQLDatabase</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2017.01] - November 2017</NoteLine>
   <NoteLine> New:</NoteLine>
   <NoteLine>  - GUID support</NoteLine>
   <NoteLine>  - Support for PostgreSQL Views</NoteLine>
   <NoteLine>  - Rollback Method to MSSQLServerAdapter</NoteLine>
   <NoteLine>  - Dictionary for ARGen Audit trail</NoteLine>
   <NoteLine>  - Support for currencty DB type</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine> Fixed:</NoteLine>
   <NoteLine>  - Decimal type no longer missing from MySQL</NoteLine>
   <NoteLine>  - Corrected compiler constants for missing DB plugins</NoteLine>
   <NoteLine>  - PostgreSQL no longer returns the wrong ID on insert</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2015.01] - Fall 2015</NoteLine>
   <NoteLine> New Features:</NoteLine>
   <NoteLine>  - Added ODBC Database to the project</NoteLine>
   <NoteLine>  - Added SQLite Valentina to the project.  Thanks to Ruslan for providing it.</NoteLine>
   <NoteLine>  - Added the View Class.  As the name suggests it allows access to Database Views.</NoteLine>
   <NoteLine>  - Added transaction example to project.</NoteLine>
   <NoteLine>  - Added View (personList) to the example</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine> Changes:</NoteLine>
   <NoteLine>  - Removed some old (and ineffective) Transactional processing code.</NoteLine>
   <NoteLine>  - Cleaned up the demo project to fit more modern BKeeney Standards</NoteLine>
   <NoteLine>  - Fixed a null date issue</NoteLine>
   <NoteLine>  - Optimized desktop version to speed inserts and updates</NoteLine>
   <NoteLine>  - Optimized Field definition to speed up inserts and updates</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine> Totally Unsupported and untested</NoteLine>
   <NoteLine>  - Oracle</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine> Broken in Current Xojo Implementations</NoteLine>
   <NoteLine>  - MS SQL Server - Prepared statements are FUBAR'ed.</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2014.01] - May 2014</NoteLine>
   <NoteLine> - Added TP_ActiveRecord to hold configuration constants.</NoteLine>
   <NoteLine> - It's no longer necessary to delete code for database plugins that aren't installed.</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2013.01] - Nov 2013</NoteLine>
   <NoteLine> - Added Oracle (totally unsupported and if it doesn't work please don't ask!)</NoteLine>
   <NoteLine> - Added CubeSQL Support</NoteLine>
   <NoteLine> - Added more descriptions when errors occur when plugins are missing</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>###</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>[2013.01] - May 2013</NoteLine>
   <NoteLine> - Removed dependencies to Monkeybread</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine></NoteLine>
  </ItemSource>
  <ItemFlags>0</ItemFlags>
 </Note>
 <Property>
  <ItemName>csCtx</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2136823807</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>csCtx As CriticalSection</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>csCtx As CriticalSection</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <SetAccessor>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Set</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Set</SourceLine>
  </SetAccessor>
  <GetAccessor>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Get</SourceLine>
   <SourceLine>if m_csCtx=nil then</SourceLine>
   <SourceLine>'Mutexes work on Mac and Linux but not Windows.</SourceLine>
   <SourceLine>'CriticalSections work on Windows but not Mac.</SourceLine>
   <SourceLine>'(Verified as of 2011 R4.1)</SourceLine>
   <SourceLine>#if TargetWin32</SourceLine>
   <SourceLine>m_csCtx = new CriticalSection</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>m_csCtx = new Mutex("")</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>return m_csCtx</SourceLine>
   <SourceLine>End Get</SourceLine>
  </GetAccessor>
 </Property>
 <Property>
  <ItemName>m_csCtx</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1735325695</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_csCtx As CriticalSection</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_csCtx As CriticalSection</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_ctxDefault</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>104491007</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_ctxDefault As TP_ActiveRecord.P.Context</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_ctxDefault As TP_ActiveRecord.P.Context</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_dictContext</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1044692991</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_dictContext As Dictionary</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_dictContext As Dictionary</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kConfigUseCubeDatabase</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1833428991</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseMSSQLServer</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1172443135</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseMSSQLServerMBS</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1686089727</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseMySQLCommunityServer</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1555171327</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseODBC</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1131438079</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUsePostgreSQLDatabase</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1898614783</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseSQLiteDatabase</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>829562879</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>True</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kConfigUseVSQLiteDatabase</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>160110591</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>3</ItemType>
  <ItemDef>False</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kDoubleNullSentinal</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1532631039</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>2</ItemType>
  <ItemDef>1.7E+308</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kVersion</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>817414143</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>2</ItemType>
  <ItemDef>2021.01</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
 <Enumeration>
  <TextEncoding>134217984</TextEncoding>
  <ItemName>DBType</ItemName>
  <ItemFlags>1</ItemFlags>
  <ItemType>Integer</ItemType>
  <ItemName>DBType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1730197503</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>DInteger</SourceLine>
   <SourceLine>DSmallInt</SourceLine>
   <SourceLine>DDouble</SourceLine>
   <SourceLine>DDate</SourceLine>
   <SourceLine>DTime</SourceLine>
   <SourceLine>DTimestamp</SourceLine>
   <SourceLine>DBoolean</SourceLine>
   <SourceLine>DBlob</SourceLine>
   <SourceLine>DText</SourceLine>
   <SourceLine>DInt64</SourceLine>
   <SourceLine>DFloat</SourceLine>
   <SourceLine>DCurrency</SourceLine>
   <SourceLine>DNotUsed</SourceLine>
   <SourceLine>DDecimal</SourceLine>
  </ItemSource>
 </Enumeration>
</block>
<block type="Module" ID="924382242">
 <ObjName>DatabaseConnection</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Property>
  <ItemName>DB</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1447815167</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>DB As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>DB As Database</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>iThreadIdentifier</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>620511231</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iThreadIdentifier As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iThreadIdentifier As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>oThreadWeakRef</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>44929023</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>oThreadWeakRef As WeakRef</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>oThreadWeakRef As WeakRef</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sSessionIdentifier</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>517699583</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sSessionIdentifier As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sSessionIdentifier As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iThreadIdentifier</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>DB</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Database</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sSessionIdentifier</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="471158405">
 <ObjName>DataFile</ObjName>
 <ObjContainerID>0</ObjContainerID>
 <IsClass>0</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>ConnectionCleanup</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>754132991</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ConnectionCleanup()</SourceLine>
   <SourceLine>// Clean up closed connections</SourceLine>
   <SourceLine>if maroConnectionPool.LastIndex &lt; 0 then return</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Collect active session identifiers</SourceLine>
   <SourceLine>var arsActiveSessions() as String</SourceLine>
   <SourceLine>#if TargetWeb then</SourceLine>
   <SourceLine>var iSessionMax as Integer = App.SessionCount - 1</SourceLine>
   <SourceLine>for i as Integer = 0 to iSessionMax</SourceLine>
   <SourceLine>var oThis as WebSession = App.SessionAt(i)</SourceLine>
   <SourceLine>if oThis &lt;&gt; nil then</SourceLine>
   <SourceLine>arsActiveSessions.Add(oThis.Identifier)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>#pragma unused arsActiveSessions</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for i as Integer = maroConnectionPool.LastIndex downto 0</SourceLine>
   <SourceLine>var oThis as TP_ActiveRecord.DatabaseConnection = maroConnectionPool(i)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Thread identified connection, now closed</SourceLine>
   <SourceLine>if (oThis.iThreadIdentifier &gt; 0 and oThis.oThreadWeakRef = nil) then</SourceLine>
   <SourceLine>oThis.DB.Close</SourceLine>
   <SourceLine>oThis.DB = nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Remove the last reference</SourceLine>
   <SourceLine>maroConnectionPool.RemoveAt(i)</SourceLine>
   <SourceLine>continue for i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Thread identified by session</SourceLine>
   <SourceLine>#if TargetWeb then</SourceLine>
   <SourceLine>if oThis.sSessionIdentifier &lt;&gt; "" then</SourceLine>
   <SourceLine>// Check to see if the session has closed</SourceLine>
   <SourceLine>if oThis.sSessionIdentifier &lt;&gt; "App" and _</SourceLine>
   <SourceLine>arsActiveSessions.IndexOf(oThis.sSessionIdentifier) &lt; 0 then</SourceLine>
   <SourceLine>oThis.DB.Close</SourceLine>
   <SourceLine>oThis.DB = nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Remove the last reference</SourceLine>
   <SourceLine>maroConnectionPool.RemoveRowAt(i)</SourceLine>
   <SourceLine>continue for i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next i</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>DB</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2096676863</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function DB() As Database</SourceLine>
   <SourceLine>// Connection cleanup</SourceLine>
   <SourceLine>ConnectionCleanup</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Begin the Sorting Hat</SourceLine>
   <SourceLine>#if TargetDesktop or (TargetConsole and not TargetWeb) then</SourceLine>
   <SourceLine>return GetDesktopConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#elseif TargetWeb then</SourceLine>
   <SourceLine>return GetWebConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetConnectionByCurrentThread</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>270077951</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetConnectionByCurrentThread() As Database</SourceLine>
   <SourceLine>// Find or create a connection identified by the current thread identifier</SourceLine>
   <SourceLine>var oCurrent as Thread = Thread.Current</SourceLine>
   <SourceLine>var iThreadID as Integer = oCurrent.ThreadID</SourceLine>
   <SourceLine>var oConnection as TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for i as Integer = 0 to maroConnectionPool.LastIndex</SourceLine>
   <SourceLine>var oThisConnection as TP_ActiveRecord.DatabaseConnection = maroConnectionPool(i)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Found the connection</SourceLine>
   <SourceLine>if oThisConnection.iThreadIdentifier = iThreadID then</SourceLine>
   <SourceLine>oConnection = oThisConnection</SourceLine>
   <SourceLine>exit for i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Create the connection if necessary</SourceLine>
   <SourceLine>if oConnection = nil then</SourceLine>
   <SourceLine>var oDatabase as Database = OpenDB</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oDatabase = nil then</SourceLine>
   <SourceLine>// The database failed to connect, you should handle this.</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Create the connection object</SourceLine>
   <SourceLine>var oNewConnection as new TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine>oNewConnection.iThreadIdentifier = iThreadID</SourceLine>
   <SourceLine>oNewConnection.oThreadWeakRef = new WeakRef(oCurrent)</SourceLine>
   <SourceLine>oNewConnection.DB = oDatabase</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oConnection = oNewConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Store it</SourceLine>
   <SourceLine>maroConnectionPool.Add(oNewConnection)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Forcibly release this</SourceLine>
   <SourceLine>oCurrent = nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Return the Database</SourceLine>
   <SourceLine>return Database(oConnection.DB)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabase</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1372743679</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabase() As Database</SourceLine>
   <SourceLine>// Prepares a %db_type% object to connect</SourceLine>
   <SourceLine>// Returns database object if successful</SourceLine>
   <SourceLine>#pragma Error "Set location of your database file"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>var fDB as new FolderItem("%db_path%", FolderItem.PathModes.Native)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var oLocalDB as new SQLiteDatabase</SourceLine>
   <SourceLine>oLocalDB.DatabaseFile = fDB</SourceLine>
   <SourceLine>// oLocalDB.EncryptionKey = ""</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Return the object</SourceLine>
   <SourceLine>return oLocalDB</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch e as UnsupportedFormatException</SourceLine>
   <SourceLine>// Be sure to set up the database path in GetDatabaseFile</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabase_Server</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1544851455</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabase_Server() As Database</SourceLine>
   <SourceLine>// Prepares a Database object to connect</SourceLine>
   <SourceLine>// Returns database object if successful</SourceLine>
   <SourceLine>var oLocalDB as new PostgreSQLDatabase</SourceLine>
   <SourceLine>oLocalDB.Host = "%template_host%"</SourceLine>
   <SourceLine>oLocalDB.Port = 5432</SourceLine>
   <SourceLine>oLocalDB.DatabaseName = "%template_databasename%"</SourceLine>
   <SourceLine>oLocalDB.UserName = "%template_username%"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma Error "Supply password for the database." // Delete this line when done.</SourceLine>
   <SourceLine>oLocalDB.Password = "" // Consider obfuscating the password String</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oLocalDB</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabase_ServerSSL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1732071423</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabase_ServerSSL() As Database</SourceLine>
   <SourceLine>// Prepares a PostgreSQLDatabase object to connect</SourceLine>
   <SourceLine>// Returns database object if successful</SourceLine>
   <SourceLine>var oLocalDB as new PostgreSQLDatabase</SourceLine>
   <SourceLine>oLocalDB.Host = "%template_host%"</SourceLine>
   <SourceLine>oLocalDB.Port = 5432</SourceLine>
   <SourceLine>oLocalDB.DatabaseName = "%template_databasename%"</SourceLine>
   <SourceLine>oLocalDB.UserName = "%template_username%"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma Error "Supply password for the database." // Delete this line when done.</SourceLine>
   <SourceLine>oLocalDB.Password = "" // Consider obfuscating the password String</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer then</SourceLine>
   <SourceLine>if oLocalDB isa MySQLCommunityServer then</SourceLine>
   <SourceLine>// Configure SSL</SourceLine>
   <SourceLine>oLocalDB.SSLMode = true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oLocalDB.SSLAuthority = %SSLAuthority%</SourceLine>
   <SourceLine>oLocalDB.SSLAuthorityDirectory = %SSLAuthorityDirectory%</SourceLine>
   <SourceLine>oLocalDB.SSLCertificate = %SSLCertificate%</SourceLine>
   <SourceLine>oLocalDB.SSLKey = %SSLKey%</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#elseif TP_ActiveRecord.kConfigUsePostgreSQLDatabase then</SourceLine>
   <SourceLine>if oLocalDB isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>// Configure SSL</SourceLine>
   <SourceLine>oLocalDB.SSLMode = PostgreSQLDatabase.SSLPrefer</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oLocalDB.SSLAuthority = %SSLAuthority%</SourceLine>
   <SourceLine>oLocalDB.SSLCertificate = %SSLCertificate%</SourceLine>
   <SourceLine>oLocalDB.SSLKey = %SSLKey%</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oLocalDB</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDesktopConnection</ItemName>
  <Compatibility>(TargetConsole and (Target32Bit or Target64Bit)) or  (TargetDesktop and (Target32Bit or Target64Bit))</Compatibility>
  <Visible>1</Visible>
  <PartID>505964543</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDesktopConnection() As Database</SourceLine>
   <SourceLine>// Identify by thread</SourceLine>
   <SourceLine>if Thread.Current = nil then</SourceLine>
   <SourceLine>// Create the connection if necessary</SourceLine>
   <SourceLine>if maroConnectionPool.LastIndex &lt; 0 then</SourceLine>
   <SourceLine>var oDatabase as Database = OpenDB</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oDatabase = nil then</SourceLine>
   <SourceLine>// The database failed to connect, you should handle this.</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Create the connection object</SourceLine>
   <SourceLine>var oConnection as new TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine>oConnection.DB = oDatabase</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Store it</SourceLine>
   <SourceLine>maroConnectionPool.Add(oConnection)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Return the connection</SourceLine>
   <SourceLine>return Database(maroConnectionPool(0).DB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>// In a thread, find by thread ID</SourceLine>
   <SourceLine>return GetConnectionByCurrentThread</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetWebConnection</ItemName>
  <Compatibility>(TargetWeb and (Target32Bit or Target64Bit))</Compatibility>
  <Visible>1</Visible>
  <PartID>1014835199</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetWebConnection() As Database</SourceLine>
   <SourceLine>// Connection cleanup</SourceLine>
   <SourceLine>ConnectionCleanup</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Attempt to identify by Session</SourceLine>
   <SourceLine>if Session &lt;&gt; nil then</SourceLine>
   <SourceLine>return GetWebConnectionBySession(Session.Identifier)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>// Identify by thread</SourceLine>
   <SourceLine>if App.CurrentThread = nil then</SourceLine>
   <SourceLine>// Main thread - use "Session" identifier: "App"</SourceLine>
   <SourceLine>return GetWebConnectionBySession("App")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>// In a thread, find by thread ID</SourceLine>
   <SourceLine>return GetConnectionByCurrentThread</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetWebConnectionBySession</ItemName>
  <Compatibility>(TargetWeb and (Target32Bit or Target64Bit))</Compatibility>
  <Visible>1</Visible>
  <PartID>300232703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetWebConnectionBySession(sIdentifier as String) As Database</SourceLine>
   <SourceLine>// Find or create a connection identified by a session string</SourceLine>
   <SourceLine>var oConnection as TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for i as Integer = 0 to maroConnectionPool.LastIndex</SourceLine>
   <SourceLine>var oThisConnection as TP_ActiveRecord.DatabaseConnection = maroConnectionPool(i)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Found the connection</SourceLine>
   <SourceLine>if oThisConnection.sSessionIdentifier = sIdentifier then</SourceLine>
   <SourceLine>oConnection = oThisConnection</SourceLine>
   <SourceLine>exit for i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next i</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Create the connection if necessary</SourceLine>
   <SourceLine>if oConnection = nil then</SourceLine>
   <SourceLine>var oDatabase as Database = OpenDB</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oDatabase = nil then</SourceLine>
   <SourceLine>// The database failed to connect, you should handle this.</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Create the connection object</SourceLine>
   <SourceLine>var oNewConnection as new TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine>oNewConnection.DB = oDatabase</SourceLine>
   <SourceLine>oNewConnection.sSessionIdentifier = sIdentifier</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oConnection = oNewConnection</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Store it</SourceLine>
   <SourceLine>maroConnectionPool.Add(oNewConnection)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Return the Database</SourceLine>
   <SourceLine>return Database(oConnection.DB)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sIdentifier as String</ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>OpenDB</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>21993471</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function OpenDB() As Database</SourceLine>
   <SourceLine>// Get a configured Databse object</SourceLine>
   <SourceLine>var oLocalDB as Database = GetDatabase</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Test connection</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>oLocalDB.Connect</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch ex as DatabaseException</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Make any db updates here before registering</SourceLine>
   <SourceLine>TP_DBUpdates.UpdateDB(oLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Important to tell ActiveRecord what the connection is!</SourceLine>
   <SourceLine>TP_ActiveRecord.Connect(GetTypeInfo(DataFile.ActiveRecordBase), oLocalDB)</SourceLine>
   <SourceLine>TP_ActiveRecord.Connect(GetTypeInfo(DataFile.ActiveRecordView), oLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Register the tables with ActiveRecord</SourceLine>
   <SourceLine>Register(oLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Return the object</SourceLine>
   <SourceLine>return oLocalDB</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>Register</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2012596223</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Register(oLocalDB as Database)</SourceLine>
   <SourceLine>#pragma unused oLocalDB</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Tables</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Views</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oLocalDB as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>maroConnectionPool()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>368181247</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>maroConnectionPool() As TP_ActiveRecord.DatabaseConnection</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>maroConnectionPool() As TP_ActiveRecord.DatabaseConnection</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kMaxReturn</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1667323903</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>2</ItemType>
  <ItemDef>50</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
</block>
<block type="BuildStepsList" ID="309999615">
 <ObjName>Linux</ObjName>
 <ObjContainerID>149562060</ObjContainerID>
</block>
<block type="BuildProjectStep" ID="465532927">
 <ObjName>Build</ObjName>
 <ObjContainerID>309999615</ObjContainerID>
</block>
<block type="BuildStepsList" ID="1436133375">
 <ObjName>Mac OS X</ObjName>
 <ObjContainerID>149562060</ObjContainerID>
</block>
<block type="BuildProjectStep" ID="1177858047">
 <ObjName>Build</ObjName>
 <ObjContainerID>1436133375</ObjContainerID>
</block>
<block type="BuildStepsList" ID="530241535">
 <ObjName>Windows</ObjName>
 <ObjContainerID>149562060</ObjContainerID>
</block>
<block type="BuildProjectStep" ID="569559039">
 <ObjName>Build</ObjName>
 <ObjContainerID>530241535</ObjContainerID>
</block>
<block type="BuildAutomation" ID="149562060">
 <ObjName>Build Automation</ObjName>
 <ObjContainerID>0</ObjContainerID>
</block>
<block type="Module" ID="2121990330">
 <ObjName>P</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>0</IsClass>
 <ItemFlags>2</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1382836112">
 <ObjName>Context</ObjName>
 <ObjContainerID>2121990330</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>ConnectionAdapter_Count</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1619761151</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ConnectionAdapter_Count() As Integer</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>//BK 04Sept2015:  Really only needed on web apps.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_dictTypeDb=nil then</SourceLine>
   <SourceLine>return 0</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>return m_dictTypeDb.KeyCount</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <Method>
  <ItemName>ConnectionAdapter_Get</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1780275199</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ConnectionAdapter_Get(ty as Introspection.TypeInfo) As DatabaseAdapter</SourceLine>
   <SourceLine>'Start with this class and search the hash table in TP_ActiveRecord for</SourceLine>
   <SourceLine>'a database to use.</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>//BK 04Sept2015:  Really only needed on web apps.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_dictTypeDb=nil then</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'start with the given type and walk up the inheritance chain</SourceLine>
   <SourceLine>'looking for a databsae connection</SourceLine>
   <SourceLine>while ty&lt;&gt;nil</SourceLine>
   <SourceLine>adp = m_dictTypeDb.Lookup(ty.FullName, nil )</SourceLine>
   <SourceLine>if adp&lt;&gt;nil then</SourceLine>
   <SourceLine>exit while</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ty = ty.BaseType</SourceLine>
   <SourceLine>wend</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return adp</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo</ItemParams>
  <ItemResult>DatabaseAdapter</ItemResult>
 </Method>
 <Method>
  <ItemName>ConnectionAdapter_Remove</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1126234111</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ConnectionAdapter_Remove(ty as Introspection.TypeInfo)</SourceLine>
   <SourceLine>'Disconnect a specific active record class from the database</SourceLine>
   <SourceLine>if ty=nil then</SourceLine>
   <SourceLine>raise new NilObjectException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if  not ty.IsSubclassOf( GetTypeInfo(TP_ActiveRecord.Base) ) and _</SourceLine>
   <SourceLine>not ty.IsSubclassOf( GetTypeInfo(TP_ActiveRecord.View) ) then</SourceLine>
   <SourceLine>raise new ActiveRecordException("Invalid type. Expected a subclass of TP_ActiveRecord.Base")</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>if m_dictTypeDb&lt;&gt;nil then</SourceLine>
   <SourceLine>m_dictTypeDb.Remove(ty.FullName)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ConnectionAdapter_Set</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2127308799</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ConnectionAdapter_Set(ty as Introspection.TypeInfo, adp as TP_ActiveRecord.DatabaseAdapter)</SourceLine>
   <SourceLine>'Connect a specific active record class and all of its subclasses to a database</SourceLine>
   <SourceLine>if ty=nil or adp=nil then</SourceLine>
   <SourceLine>raise new NilObjectException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if  not ty.IsSubclassOf( GetTypeInfo(TP_ActiveRecord.Base) ) and _</SourceLine>
   <SourceLine>not ty.IsSubclassOf( GetTypeInfo(TP_ActiveRecord.View) ) then</SourceLine>
   <SourceLine>raise new ActiveRecordException("Invalid type. Expected a subclass of TP_ActiveRecord.Base")</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'add the database using the full type name of the type as a key</SourceLine>
   <SourceLine>'Base will use this to find the appropriate adapter.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>if m_dictTypeDb=nil then</SourceLine>
   <SourceLine>m_dictTypeDb = new Dictionary</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_dictTypeDb.Value(ty.FullName) = adp</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, adp as TP_ActiveRecord.DatabaseAdapter</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>671985663</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor()</SourceLine>
   <SourceLine>'Mutexes work on Mac and Linux but not Windows.</SourceLine>
   <SourceLine>'CriticalSections work on Windows but not Mac.</SourceLine>
   <SourceLine>'(Verified as of 2011 R4.1)</SourceLine>
   <SourceLine>#if TargetWin32</SourceLine>
   <SourceLine>m_cs = new CriticalSection</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>m_cs = new Mutex("")</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>TableInfo_Get</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1321267199</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function TableInfo_Get(ty as Introspection.TypeInfo) As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>//BK 04Sept2015:  Really only needed on web apps.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'check the info cache and return the mapping if it exists</SourceLine>
   <SourceLine>if m_dictTypeTableInfo=nil then</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return m_dictTypeTableInfo.Lookup(ty.FullName, nil)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo</ItemParams>
  <ItemResult>TP_ActiveRecord.P.TableInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>TableInfo_List</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>713160703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function TableInfo_List() As TP_ActiveRecord.P.TableInfo()</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>//BK 04Sept2015:  Really only needed on web apps.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'check the info cache and return the mapping if it exists</SourceLine>
   <SourceLine>Var aro() as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>if m_dictTypeTableInfo=nil then</SourceLine>
   <SourceLine>return aro</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each sKey as string in m_dictTypeTableInfo.Keys</SourceLine>
   <SourceLine>Var o as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>o = m_dictTypeTableInfo.Value(sKey)</SourceLine>
   <SourceLine>aro.Add(o)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>return aro</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.P.TableInfo()</ItemResult>
 </Method>
 <Method>
  <ItemName>TableInfo_Set</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>457857023</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub TableInfo_Set(ty as Introspection.TypeInfo, oTableInfo as TP_ActiveRecord.P.TableInfo)</SourceLine>
   <SourceLine>#if TargetWeb</SourceLine>
   <SourceLine>//BK 04Sept2015:  Really only needed on web apps.</SourceLine>
   <SourceLine>Var lck as new TP_ActiveRecord.P.ScopedLock(m_cs)</SourceLine>
   <SourceLine>#pragma unused lck</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_dictTypeTableInfo=nil then</SourceLine>
   <SourceLine>m_dictTypeTableInfo = new Dictionary</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_dictTypeTableInfo.Value(ty.FullName) = oTableInfo</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, oTableInfo as TP_ActiveRecord.P.TableInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_cs</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1106046975</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_cs As CriticalSection</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_cs As CriticalSection</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_dictTypeDb</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>796434431</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_dictTypeDb As Dictionary</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_dictTypeDb As Dictionary</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_dictTypeTableInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1019731967</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_dictTypeTableInfo As Dictionary</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_dictTypeTableInfo As Dictionary</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1258523356">
 <ObjName>ScopedLock</ObjName>
 <ObjContainerID>2121990330</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>757475327</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(cs as CriticalSection)</SourceLine>
   <SourceLine>if cs is nil then</SourceLine>
   <SourceLine>raise new ActiveRecordException("Lock is set to Nil")</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_cs = cs</SourceLine>
   <SourceLine>m_cs.Enter</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>cs as CriticalSection</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Destructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1822214143</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Destructor()</SourceLine>
   <SourceLine>m_cs.Leave</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Note>
  <ItemName>Overview</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>794025983</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <NoteLine>Overview</NoteLine>
   <NoteLine>The Constructor for this class accepts a CriticalSection and immediately calls the Enter method.</NoteLine>
   <NoteLine>The Destructor calls Leave.</NoteLine>
   <NoteLine></NoteLine>
   <NoteLine>You can use this class to hold a lock for the duration of the object's life. For example, if you</NoteLine>
   <NoteLine>create it at the beginning of a method than the lock will be held until the method is complete.</NoteLine>
   <NoteLine>The advantage of this is that the object will be destroyed regardless of how the method ends,</NoteLine>
   <NoteLine>via a return statement or an exception or whatever.</NoteLine>
  </ItemSource>
  <ItemFlags>0</ItemFlags>
 </Note>
 <Property>
  <ItemName>m_cs</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>691341311</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_cs As CriticalSection</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_cs As CriticalSection</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1435621795">
 <ObjName>FieldInfo</ObjName>
 <ObjContainerID>2121990330</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>627564543</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(sField as string, pi as Introspection.PropertyInfo, oTypeInfo as Introspection.TypeInfo)</SourceLine>
   <SourceLine>self.sFieldName = sField</SourceLine>
   <SourceLine>self.piFieldProperty = pi</SourceLine>
   <SourceLine>self.moTypeInfo = oTypeInfo.BaseType</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sField as string, pi as Introspection.PropertyInfo, oTypeInfo as Introspection.TypeInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>IsKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>613709823</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsKey() As Boolean</SourceLine>
   <SourceLine>return (bForeignKey or bPrimaryKey)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>SetDBType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1335400447</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub SetDBType()</SourceLine>
   <SourceLine>//First Get the Database Type</SourceLine>
   <SourceLine>Var ctx as TP_ActiveRecord.P.Context = GetContext</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = ctx.ConnectionAdapter_Get(moTypeInfo)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var db as database = adp.Db</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>select case db</SourceLine>
   <SourceLine>case nil</SourceLine>
   <SourceLine>'empty. This just let's it compile if someone turns off all the constants</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>case isa SQLiteDatabase</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BOOLEAN</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BLOB</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>case isa MySQLCommunityServer</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_LONG</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_SHORT</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_DATE</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_TIME</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_TIMESTAMP</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_TINY</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_BLOB</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_STRING</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_LONGLONG</SourceLine>
   <SourceLine>case DBType.DFloat, DBType.DDecimal</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_DOUBLE</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = MySQLPreparedStatement.MYSQL_TYPE_DOUBLE</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Postgres doesn't use bind types.</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer</SourceLine>
   <SourceLine>case isa MSSQLServerDatabase</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_BIGINT</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_SMALLINT</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_DATE</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_TIME</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_TIMESTAMP</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_TINYINT</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_BINARY</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_STRING</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_BIGINT</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_FLOAT</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_BIGINT</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServerMBS then</SourceLine>
   <SourceLine>case isa SQLDatabaseMBS</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeUInt64</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeUShort</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeDouble</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeDateTime</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeDateTime</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeUInt64</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeBool</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeBlob</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeString</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeUInt64</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeDouble</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = SQLPreparedStatementMBS.kTypeUInt64</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC</SourceLine>
   <SourceLine>case isa ODBCDatabase</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_INTEGER</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_INTEGER</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_TIMESTAMP //Why Timestamp?  Testing shows that's the only thing works</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_STRING</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_TIMESTAMP</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_TINYINT</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_BINARY</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_STRING</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_BIGINT</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_FLOAT</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = ODBCPreparedStatement.ODBC_TYPE_BIGINT</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>case isa CubeSQLServer</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BOOLEAN</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BLOB</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>case isa VSQLiteDatabase</SourceLine>
   <SourceLine>select case enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BOOLEAN</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BLOB</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>bForeignKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>650901503</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>bForeignKey As boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>bForeignKey As boolean</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>bPrimaryKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>677711871</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>bPrimaryKey As boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>bPrimaryKey As boolean</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>enFieldType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1807357951</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>enFieldType As TP_ActiveRecord.DBType</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>enFieldType As TP_ActiveRecord.DBType</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <SetAccessor>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Set</SourceLine>
   <SourceLine>menFieldType = value</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>SetDBType</SourceLine>
   <SourceLine>End Set</SourceLine>
  </SetAccessor>
  <GetAccessor>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Get</SourceLine>
   <SourceLine>return menFieldType</SourceLine>
   <SourceLine>End Get</SourceLine>
  </GetAccessor>
 </Property>
 <Property>
  <ItemName>iDBType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>791373823</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iDBType As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iDBType As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>menFieldType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1627080703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>menFieldType As TP_ActiveRecord.DBType</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>menFieldType As TP_ActiveRecord.DBType</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>moTypeInfo</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2117793791</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>moTypeInfo As Introspection.TypeInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>moTypeInfo As Introspection.TypeInfo</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>piFieldProperty</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2095034367</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>piFieldProperty As Introspection.PropertyInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>piFieldProperty As Introspection.PropertyInfo</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sFieldName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>107663359</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sFieldName As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sFieldName As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>bForeignKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>boolean</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>bPrimaryKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>boolean</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iDBType</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sFieldName</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>enFieldType</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>TP_ActiveRecord.DBType</ItemType>
   <EditorType>Enum</EditorType>
   <Enumeration>
    <ItemDef>0 - DInteger</ItemDef>
    <ItemDef>1 - DSmallInt</ItemDef>
    <ItemDef>2 - DDouble</ItemDef>
    <ItemDef>3 - DDate</ItemDef>
    <ItemDef>4 - DTime</ItemDef>
    <ItemDef>5 - DTimestamp</ItemDef>
    <ItemDef>6 - DBoolean</ItemDef>
    <ItemDef>7 - DBlob</ItemDef>
    <ItemDef>8 - DText</ItemDef>
    <ItemDef>9 - DInt64</ItemDef>
    <ItemDef>10 - DFloat</ItemDef>
    <ItemDef>11 - DCurrency</ItemDef>
    <ItemDef>12 - DNotUsed</ItemDef>
    <ItemDef>13 - DDecimal</ItemDef>
   </Enumeration>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1516751326">
 <ObjName>TableInfo</ObjName>
 <ObjContainerID>2121990330</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Property>
  <ItemName>aroField()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>439408639</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>aroField() As TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>aroField() As TP_ActiveRecord.P.FieldInfo</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>piPrimaryKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>473014271</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>piPrimaryKey As Introspection.PropertyInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>piPrimaryKey As Introspection.PropertyInfo</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sPrimaryKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1752002559</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sPrimaryKey As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sPrimaryKey As string</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sTableName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1892495359</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sTableName As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sTableName As string</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>tyClass</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>26857471</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>tyClass As Introspection.TypeInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>tyClass As Introspection.TypeInfo</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sPrimaryKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>string</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sTableName</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>string</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1290477060">
 <ObjName>Base</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BuildChangeLog</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1900521471</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function BuildChangeLog() As TP_AuditTrail.ChangeLog()</SourceLine>
   <SourceLine>var aro() as TP_AuditTrail.ChangeLog</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(self) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldInfo as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>var pi as Introspection.PropertyInfo = oFieldInfo.piFieldProperty</SourceLine>
   <SourceLine>var vProperty as Variant = pi.Value( self )</SourceLine>
   <SourceLine>var vSavedValue as Variant</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_dictOrigValues&lt;&gt;nil then</SourceLine>
   <SourceLine>vSavedValue = m_dictOrigValues.Lookup(pi.Name, nil)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'cast the saved value so the type matches the property type</SourceLine>
   <SourceLine>select case vProperty.Type</SourceLine>
   <SourceLine>case Variant.TypeInt32</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.IntegerValue</SourceLine>
   <SourceLine>case Variant.TypeInt64</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.Int64Value</SourceLine>
   <SourceLine>case Variant.TypeSingle</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.SingleValue</SourceLine>
   <SourceLine>case Variant.TypeDouble</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.DoubleValue</SourceLine>
   <SourceLine>case Variant.TypeCurrency</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.CurrencyValue</SourceLine>
   <SourceLine>case Variant.TypeString</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.StringValue</SourceLine>
   <SourceLine>case Variant.TypeBoolean</SourceLine>
   <SourceLine>vSavedValue =  vSavedValue.BooleanValue</SourceLine>
   <SourceLine>case Variant.TypeColor</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.ColorValue</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if vProperty.Type=Variant.TypeString then</SourceLine>
   <SourceLine>'do a case sensitive compare for Strings</SourceLine>
   <SourceLine>if vProperty.StringValue.Compare(vSavedValue.StringValue, ComparisonOptions.CaseSensitive) &lt;&gt; 0 then</SourceLine>
   <SourceLine>var oChange as new TP_AuditTrail.ChangeLog</SourceLine>
   <SourceLine>oChange.sFieldName = oFieldInfo.sFieldName</SourceLine>
   <SourceLine>oChange.sNewValue = vProperty.StringValue</SourceLine>
   <SourceLine>oChange.sOldValue = vSavedValue.StringValue</SourceLine>
   <SourceLine>aro.Add(oChange)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>'use the default comparison operator for everything else</SourceLine>
   <SourceLine>if vProperty&lt;&gt;vSavedValue then</SourceLine>
   <SourceLine>var oChange as new TP_AuditTrail.ChangeLog</SourceLine>
   <SourceLine>oChange.sFieldName = oFieldInfo.sFieldName</SourceLine>
   <SourceLine>oChange.sNewValue = vProperty.StringValue</SourceLine>
   <SourceLine>oChange.sOldValue = vSavedValue.StringValue</SourceLine>
   <SourceLine>aro.Add(oChange)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return aro</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_AuditTrail.ChangeLog()</ItemResult>
 </Method>
 <Method>
  <ItemName>Clone</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1913102335</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Clone() As Variant</SourceLine>
   <SourceLine>Var ty as Introspection.TypeInfo = Introspection.GetType(self)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo = GetTableInfo(ty)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oSuperConstructor as Introspection.ConstructorInfo</SourceLine>
   <SourceLine>Var oCopyConstructor as Introspection.ConstructorInfo</SourceLine>
   <SourceLine>Var oDefaultConstructor as Introspection.ConstructorInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Look for three types of constructors (lowest priority first):</SourceLine>
   <SourceLine>' (1) Default constructors (i.e. no parameters)</SourceLine>
   <SourceLine>' (2) Constructors that take a parameter of which self's class is a subtype</SourceLine>
   <SourceLine>' (3) Constructors that take a parameter which matches this class type</SourceLine>
   <SourceLine>'</SourceLine>
   <SourceLine>'For example if there's a class call User derived like this:</SourceLine>
   <SourceLine>' TP_ActiveRecord.Base -&gt; clsActiveRecord -&gt; User</SourceLine>
   <SourceLine>'Then the program will look for constructors like the following:</SourceLine>
   <SourceLine>' (1) Constructor()</SourceLine>
   <SourceLine>' (2) Constructor(TP_ActiveRecord.Base)</SourceLine>
   <SourceLine>' (3) Constructor(clsActiveRecord)</SourceLine>
   <SourceLine>' (4) Constructor(User)</SourceLine>
   <SourceLine>'If it finds more than one it will use the one that's farthest down the list.</SourceLine>
   <SourceLine>'The point of this is to give users a way of customizing how their objects</SourceLine>
   <SourceLine>'get cloned, all they need to do is add the appropriate constructor</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each o as Introspection.ConstructorInfo in ty.GetConstructors</SourceLine>
   <SourceLine>Var aroParam() as Introspection.ParameterInfo</SourceLine>
   <SourceLine>aroParam = o.GetParameters</SourceLine>
   <SourceLine>if aroParam.LastIndex &lt; 0 then</SourceLine>
   <SourceLine>'default constructor</SourceLine>
   <SourceLine>oDefaultConstructor = o</SourceLine>
   <SourceLine>elseif aroParam.LastIndex=0 and _</SourceLine>
   <SourceLine>ty.IsSubclassOf(aroParam(0).ParameterType) then</SourceLine>
   <SourceLine>'copy constructor that takes a super class</SourceLine>
   <SourceLine>if oSuperConstructor=nil then</SourceLine>
   <SourceLine>oSuperConstructor = o</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var aroCurrentParam() as Introspection.ParameterInfo</SourceLine>
   <SourceLine>aroCurrentParam = oSuperConstructor.GetParameters</SourceLine>
   <SourceLine>if aroParam(0).ParameterType.IsSubclassOf(aroCurrentParam(0).ParameterType) then</SourceLine>
   <SourceLine>'if the parameter type of this constructor is derived from the parameter type</SourceLine>
   <SourceLine>'of the last one, then this one should have priority</SourceLine>
   <SourceLine>oSuperConstructor = o</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>elseif aroParam.LastIndex=0 and _</SourceLine>
   <SourceLine>aroParam(0).ParameterType is ty then</SourceLine>
   <SourceLine>'copy constructor that takes this class</SourceLine>
   <SourceLine>oCopyConstructor = o</SourceLine>
   <SourceLine>exit for</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Create an instance using the constructor we found</SourceLine>
   <SourceLine>Var oClone as Base</SourceLine>
   <SourceLine>Var vSelf as Variant = self</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oCopyConstructor&lt;&gt;nil then</SourceLine>
   <SourceLine>oClone = oCopyConstructor.Invoke(Array(vSelf))</SourceLine>
   <SourceLine>elseif oSuperConstructor&lt;&gt;nil then</SourceLine>
   <SourceLine>oClone = oSuperConstructor.Invoke(Array(vSelf))</SourceLine>
   <SourceLine>elseif oDefaultConstructor&lt;&gt;nil then</SourceLine>
   <SourceLine>oClone = oDefaultConstructor.Invoke</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>'we should always be able to find a default constructor</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert(false, _</SourceLine>
   <SourceLine>"Class does not have a default constructor")</SourceLine>
   <SourceLine>return nil</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Copy the properties into the new instance</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>Var pi as Introspection.PropertyInfo = oField.piFieldProperty</SourceLine>
   <SourceLine>if not (pi is oTableInfo.piPrimaryKey) then</SourceLine>
   <SourceLine>'copy every saved property except the primary key</SourceLine>
   <SourceLine>pi.Value(oClone) = pi.Value(self)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oClone</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Variant</ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>102117375</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor()</SourceLine>
   <SourceLine>'Empty</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>899362815</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(rs as RowSet)</SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2076307455</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return GetDatabaseAdapter.Db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>Delete</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2117115903</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Delete()</SourceLine>
   <SourceLine>if self.IsNew then</SourceLine>
   <SourceLine>return</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = GetDatabaseAdapter</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>try </SourceLine>
   <SourceLine>adp.BeginTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>RaiseEvent BeforeDelete</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.DeleteRecord(self)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>RaiseEvent AfterDelete</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.RollbackTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabaseAdapter</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>771254271</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabaseAdapter() As DatabaseAdapter</SourceLine>
   <SourceLine>return GetContext.ConnectionAdapter_Get(Introspection.GetType(self))</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>DatabaseAdapter</ItemResult>
 </Method>
 <Method>
  <ItemName>GetTableName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1567457279</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetTableName() As String</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine>Return oTableInfo.sTableName</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>GUID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1261910015</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GUID() As String</SourceLine>
   <SourceLine>Var oTableInfo As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(Self))</SourceLine>
   <SourceLine>Select Case oTableInfo.piPrimaryKey.PropertyType.Name</SourceLine>
   <SourceLine>Case "Int32", "Int64"</SourceLine>
   <SourceLine>Return ID.ToString</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>Return oTableInfo.piPrimaryKey.Value(Self)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>GUID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1326804991</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub GUID(assigns guid as String)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine>oTableInfo.piPrimaryKey.Value(self) = guid</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>assigns guid as String</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1437698047</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ID() As Int64</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine>return oTableInfo.piPrimaryKey.Value(self)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>ID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1212639231</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ID(assigns id as Int64)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine>oTableInfo.piPrimaryKey.Value(self) = id</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>assigns id as Int64</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>IsModified</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1152235519</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsModified() As Boolean</SourceLine>
   <SourceLine>return IsRecordModified</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>IsNew</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1380229119</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsNew() As Boolean</SourceLine>
   <SourceLine>Var sGUID as String = GUID</SourceLine>
   <SourceLine>if ID &lt; 1 or (sGUID = "" or sGUID = "0") then</SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>IsRecordModified</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>272490495</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsRecordModified() As Boolean</SourceLine>
   <SourceLine>Var bModified as boolean</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldInfo as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>Var pi as Introspection.PropertyInfo = oFieldInfo.piFieldProperty</SourceLine>
   <SourceLine>Var vProperty as Variant = pi.Value(self)</SourceLine>
   <SourceLine>Var vSavedValue as Variant</SourceLine>
   <SourceLine>if m_dictSavedPropertyValue&lt;&gt;nil then</SourceLine>
   <SourceLine>vSavedValue = m_dictSavedPropertyValue.Lookup(pi.Name, nil)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'cast the saved value so the type matches the property type</SourceLine>
   <SourceLine>select case vProperty.Type</SourceLine>
   <SourceLine>case Variant.TypeInt32</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.IntegerValue</SourceLine>
   <SourceLine>case Variant.TypeInt64</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.Int64Value</SourceLine>
   <SourceLine>case Variant.TypeSingle</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.SingleValue</SourceLine>
   <SourceLine>case Variant.TypeDouble</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.DoubleValue</SourceLine>
   <SourceLine>case Variant.TypeCurrency</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.CurrencyValue</SourceLine>
   <SourceLine>case Variant.TypeString</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.StringValue</SourceLine>
   <SourceLine>case Variant.TypeBoolean</SourceLine>
   <SourceLine>vSavedValue =  vSavedValue.BooleanValue</SourceLine>
   <SourceLine>case Variant.TypeColor</SourceLine>
   <SourceLine>vSavedValue = vSavedValue.ColorValue</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if vProperty.Type=Variant.TypeString then</SourceLine>
   <SourceLine>'do a case sensitive compare for strings</SourceLine>
   <SourceLine>if vProperty.StringValue.Compare(vSavedValue.StringValue, ComparisonOptions.CaseSensitive) &lt;&gt; 0 then</SourceLine>
   <SourceLine>bModified = true</SourceLine>
   <SourceLine>exit for</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>'use the default comparison operator for everything else</SourceLine>
   <SourceLine>if vProperty&lt;&gt;vSavedValue then</SourceLine>
   <SourceLine>bModified = true</SourceLine>
   <SourceLine>exit for</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return bModified</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>Load</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>742010879</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Load(iRecordID as Int64) As Boolean</SourceLine>
   <SourceLine>'Load record with the given ID. Return true if the record is found.</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>Var ada as TP_ActiveRecord.DatabaseAdapter = GetDatabaseAdapter</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase then</SourceLine>
   <SourceLine>if ada isa TP_ActiveRecord.cubeSQLDatabaseAdapter then</SourceLine>
   <SourceLine>rs = TP_ActiveRecord.cubeSQLDatabaseAdapter(ada).SelectRecord(self, iRecordID)</SourceLine>
   <SourceLine>if rs.AfterLastRow then</SourceLine>
   <SourceLine>return false</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = ada.SelectRecord(self, iRecordID)</SourceLine>
   <SourceLine>if rs.AfterLastRow then</SourceLine>
   <SourceLine>return false</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>iRecordID as Int64</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>Load</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>826988543</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Load(sRecordID as String) As Boolean</SourceLine>
   <SourceLine>'Load record with the given ID. Return true if the record is found.</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>Var ada as TP_ActiveRecord.DatabaseAdapter = GetDatabaseAdapter</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase then</SourceLine>
   <SourceLine>if ada isa TP_ActiveRecord.cubeSQLDatabaseAdapter then</SourceLine>
   <SourceLine>rs = TP_ActiveRecord.cubeSQLDatabaseAdapter(ada).SelectRecord(self, sRecordID)</SourceLine>
   <SourceLine>if rs.AfterLastRow then</SourceLine>
   <SourceLine>return false</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#Endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = ada.SelectRecord(self, sRecordID)</SourceLine>
   <SourceLine>if rs.AfterLastRow then</SourceLine>
   <SourceLine>return false</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sRecordID as String</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>Operator_Compare</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>214198271</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Operator_Compare(rhs as TP_ActiveRecord.Base) As Integer</SourceLine>
   <SourceLine>if rhs is nil then</SourceLine>
   <SourceLine>return 1</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'the two records are equal if they are actually the same object or</SourceLine>
   <SourceLine>'if they're the same type and have the same ID (except if they're new).</SourceLine>
   <SourceLine>if rhs is self or _</SourceLine>
   <SourceLine>(Introspection.GetType(self) = Introspection.GetType(rhs) and _</SourceLine>
   <SourceLine>(rhs.ID = ID) and not IsNew) then</SourceLine>
   <SourceLine>return 0</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'this ordering is arbitrary. Equality is really the case we're after.</SourceLine>
   <SourceLine>if ID &lt; rhs.ID then</SourceLine>
   <SourceLine>return -1</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>return 1</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rhs as TP_ActiveRecord.Base</ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <Method>
  <ItemName>ReadRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>525379583</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ReadRecord(rs as RowSet)</SourceLine>
   <SourceLine>'Read current record out of rs into properties</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo(Introspection.GetType(self))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord(rs, oTableInfo, m_dictSavedPropertyValue)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ReadRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2127525887</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ReadRecord(rs as RowSet, oTableInfo as TP_ActiveRecord.P.TableInfo, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>'Read current record out of rs into properties</SourceLine>
   <SourceLine>Var dictFieldValue as new Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldInfo as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>Var oField as DatabaseColumn = rs.Column(oFieldInfo.sFieldName)</SourceLine>
   <SourceLine>' Var oField As DatabaseField = rs.Column(oFieldInfo.sFieldName)</SourceLine>
   <SourceLine>Var pi as Introspection.PropertyInfo = oFieldInfo.piFieldProperty</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oField is nil then</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert(false, _</SourceLine>
   <SourceLine>"A field needed to populate this record wasn't provided: " + _</SourceLine>
   <SourceLine>oFieldInfo.sFieldName)</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var vProperty as Variant</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if pi.PropertyType.Name = "Double" then</SourceLine>
   <SourceLine>if oField.Value=nil then</SourceLine>
   <SourceLine>vProperty = TP_ActiveRecord.kDoubleNullSentinal</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>vProperty = oField.Value</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>elseif pi.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var s as string = oField.StringValue</SourceLine>
   <SourceLine>if Encoding(s) is nil then</SourceLine>
   <SourceLine>s = DefineEncoding(s, Encodings.UTF8)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>vProperty = s</SourceLine>
   <SourceLine>elseif pi.PropertyType.IsPrimitive then</SourceLine>
   <SourceLine>vProperty = oField.Value</SourceLine>
   <SourceLine>Elseif pi.PropertyType = GetTypeInfo(DateTime) Then</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var v As Variant = oField.Value</SourceLine>
   <SourceLine>If v = Nil Or v = "" Then</SourceLine>
   <SourceLine>vProperty=Nil</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>Var dt As DateTime = DateTime.FromString(v.StringValue)</SourceLine>
   <SourceLine>vProperty=dt</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>vProperty= oField.Value</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>pi.Value(self) = vProperty</SourceLine>
   <SourceLine>dictFieldValue.Value(pi.Name) = vProperty</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Make sure the instances aren't connected</SourceLine>
   <SourceLine>if pi.PropertyType = GetTypeInfo(DateTime) and vProperty &lt;&gt; nil then</SourceLine>
   <SourceLine>pi.Value(self) = DateTime.FromString(vProperty.StringValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet, oTableInfo as TP_ActiveRecord.P.TableInfo, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Save</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1460563967</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Save()</SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter = GetDatabaseAdapter</SourceLine>
   <SourceLine>adp.BeginTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>RaiseEvent BeforeSave</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if IsNew then</SourceLine>
   <SourceLine>RaiseEvent BeforeCreate</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.InsertRecord(self, m_dictSavedPropertyValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>RaiseEvent AfterSave</SourceLine>
   <SourceLine>RaiseEvent AfterCreate</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>RaiseEvent BeforeUpdate</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// ARGen Audit Trail</SourceLine>
   <SourceLine>m_dictOrigValues = TP_AuditTrail.CloneDictionary(m_dictSavedPropertyValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if IsRecordModified then</SourceLine>
   <SourceLine>adp.UpdateRecord(self, m_dictSavedPropertyValue)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>RaiseEvent AfterSave</SourceLine>
   <SourceLine>RaiseEvent AfterUpdate</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>exception ex as RuntimeException</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>adp.RollbackTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Validate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>589484031</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Validate(oError as TP_ActiveRecord.ValidationErrors) As Boolean</SourceLine>
   <SourceLine>RaiseEvent Validate(oError)</SourceLine>
   <SourceLine>return (oError.ErrorCount = 0)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oError as TP_ActiveRecord.ValidationErrors</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Hook>
  <ItemName>AfterCreate</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>AfterDelete</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>AfterSave</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>AfterUpdate</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>BeforeCreate</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>BeforeDelete</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>BeforeSave</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>BeforeUpdate</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Hook>
  <ItemName>Validate</ItemName>
  <TextEncoding>134217984</TextEncoding>
  <ItemFlags>33</ItemFlags>
  <SystemFlags>0</SystemFlags>
  <ItemParams>oErrors as TP_ActiveRecord.ValidationErrors</ItemParams>
  <ItemResult></ItemResult>
 </Hook>
 <Property>
  <ItemName>m_dictOrigValues</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1558659071</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_dictOrigValues As Dictionary</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_dictOrigValues As Dictionary</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_dictSavedPropertyValue</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1447667711</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_dictSavedPropertyValue As Dictionary</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_dictSavedPropertyValue As Dictionary</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1610613173">
 <ObjName>BaseList</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>25421823</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(ty as Introspection.TypeInfo, sCriteria as string = "", sOrder as string = "")</SourceLine>
   <SourceLine>m_tyElement = ty</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if not ty.IsSubclassOf(GetTypeInfo(TP_ActiveRecord.Base)) then</SourceLine>
   <SourceLine>Var ex as new RuntimeException</SourceLine>
   <SourceLine>ex.Message = "Invalid type"</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var adp as TP_ActiveRecord.DatabaseAdapter</SourceLine>
   <SourceLine>adp = GetContext.ConnectionAdapter_Get( ty )</SourceLine>
   <SourceLine>if adp=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>' Var aro() as Variant</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo = GetTableInfo( ty )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sql as string = "SELECT " + oTableInfo.sPrimaryKey + _</SourceLine>
   <SourceLine>" FROM " + oTableInfo.sTableName</SourceLine>
   <SourceLine>if sCriteria&lt;&gt;"" then</SourceLine>
   <SourceLine>sql = sql + " WHERE " + sCriteria</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if sOrder&lt;&gt;"" then</SourceLine>
   <SourceLine>sql = sql + " ORDER BY " + sOrder</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arid() as Int64</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = adp.SQLSelect(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var oField As DatabaseColumn = rs.ColumnAt(0)</SourceLine>
   <SourceLine>do until rs.AfterLastRow</SourceLine>
   <SourceLine>arid.Add(oField.Int64Value)</SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine>loop</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>m_arid = arid</SourceLine>
   <SourceLine>m_aro.ResizeTo(m_arid.LastIndex)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>ty as Introspection.TypeInfo, sCriteria as string = "", sOrder as string = ""</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ElementType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1333069823</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ElementType() As Introspection.TypeInfo</SourceLine>
   <SourceLine>return m_tyElement</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Introspection.TypeInfo</ItemResult>
 </Method>
 <Method>
  <ItemName>Item</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>595292159</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Item(index as integer) As TP_ActiveRecord.Base</SourceLine>
   <SourceLine>if m_aro(index)&lt;&gt;nil then</SourceLine>
   <SourceLine>return m_aro(index)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>const kBatchSize = 50</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>LoadRange(index, Min(index+kBatchSize-1, m_arid.LastIndex))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return m_aro(index)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>index as integer</ItemParams>
  <ItemResult>TP_ActiveRecord.Base</ItemResult>
 </Method>
 <Method>
  <ItemName>LoadRange</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>253995007</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub LoadRange(startIndex as integer, endIndex as integer)</SourceLine>
   <SourceLine>Var sPrimaryKey as string = GetTableInfo(m_tyElement).sPrimaryKey</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aridix() as integer</SourceLine>
   <SourceLine>Var arid() as Int64</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for i as integer = startIndex to endIndex</SourceLine>
   <SourceLine>aridix.Add(i)</SourceLine>
   <SourceLine>arid.Add(m_arid(i))</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>arid.SortWith(aridix)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsId() as string</SourceLine>
   <SourceLine>for i as integer = 0 to arid.LastIndex</SourceLine>
   <SourceLine>arsId.Add(Str(arid(i)))</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sCriteria as string</SourceLine>
   <SourceLine>sCriteria = sPrimaryKey + " IN (" + String.FromArray(arsId, ",") + ")"</SourceLine>
   <SourceLine>Var arv() as Variant = TP_ActiveRecord.Query(m_tyElement, sCriteria, sPrimaryKey)</SourceLine>
   <SourceLine>for i as integer = 0 to arv.LastIndex</SourceLine>
   <SourceLine>Var oRecord as TP_ActiveRecord.Base = arv(i)</SourceLine>
   <SourceLine>if oRecord.ID = arid(i) then</SourceLine>
   <SourceLine>m_aro(aridix(i)) = oRecord</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>startIndex as integer, endIndex as integer</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Operator_Subscript</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1198942207</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Operator_Subscript(index as Integer) As TP_ActiveRecord.Base</SourceLine>
   <SourceLine>return Item(index)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>index as Integer</ItemParams>
  <ItemResult>TP_ActiveRecord.Base</ItemResult>
 </Method>
 <Method>
  <ItemName>Ubound</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>453924863</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Ubound() As integer</SourceLine>
   <SourceLine>return m_arid.LastIndex</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>integer</ItemResult>
 </Method>
 <Property>
  <ItemName>m_arid()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>391192575</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_arid() As Int64</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_arid() As Int64</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_aro()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>899637247</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_aro() As TP_ActiveRecord.Base</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_aro() As TP_ActiveRecord.Base</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_tyElement</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1157419007</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_tyElement As Introspection.TypeInfo</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_tyElement As Introspection.TypeInfo</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="544244982">
 <ObjName>FieldDef</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2006362111</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(sFieldName as string, enFieldType as TP_ActiveRecord.DBType, bPrimaryKey as boolean, bForeignKey as boolean)</SourceLine>
   <SourceLine>self.sFieldName = sFieldName</SourceLine>
   <SourceLine>self.enFieldType = enFieldType</SourceLine>
   <SourceLine>self.IsPrimaryKey = bPrimaryKey</SourceLine>
   <SourceLine>self.IsForeignKey = bForeignKey</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sFieldName as string, enFieldType as TP_ActiveRecord.DBType, bPrimaryKey as boolean, bForeignKey as boolean</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>enFieldType</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1610211327</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>enFieldType As TP_ActiveRecord.DBType</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>enFieldType As TP_ActiveRecord.DBType</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>IsForeignKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>989560831</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>IsForeignKey As boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>IsForeignKey As boolean</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>IsPrimaryKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1340002303</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>IsPrimaryKey As boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>IsPrimaryKey As boolean</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sFieldName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1773590527</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sFieldName As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sFieldName As string</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>IsForeignKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>boolean</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>IsPrimaryKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>boolean</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sFieldName</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>string</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>enFieldType</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>TP_ActiveRecord.DBType</ItemType>
   <EditorType>Enum</EditorType>
   <Enumeration>
    <ItemDef>0 - DInteger</ItemDef>
    <ItemDef>1 - DSmallInt</ItemDef>
    <ItemDef>2 - DDouble</ItemDef>
    <ItemDef>3 - DDate</ItemDef>
    <ItemDef>4 - DTime</ItemDef>
    <ItemDef>5 - DTimestamp</ItemDef>
    <ItemDef>6 - DBoolean</ItemDef>
    <ItemDef>7 - DBlob</ItemDef>
    <ItemDef>8 - DText</ItemDef>
    <ItemDef>9 - DInt64</ItemDef>
    <ItemDef>10 - DFloat</ItemDef>
    <ItemDef>11 - DCurrency</ItemDef>
    <ItemDef>12 - DNotUsed</ItemDef>
    <ItemDef>13 - DDecimal</ItemDef>
   </Enumeration>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="992576707">
 <ObjName>TableDef</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1640245247</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(sTableName as string, sPrimaryKey as string, aroField() as TP_ActiveRecord.FieldDef)</SourceLine>
   <SourceLine>self.sTableName = sTableName</SourceLine>
   <SourceLine>self.sPrimaryKey = sPrimaryKey</SourceLine>
   <SourceLine>self.aroField = aroField</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sTableName as string, sPrimaryKey as string, aroField() as TP_ActiveRecord.FieldDef</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>aroField()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1222793215</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>aroField() As TP_ActiveRecord.FieldDef</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>aroField() As TP_ActiveRecord.FieldDef</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sPrimaryKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>689268735</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sPrimaryKey As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sPrimaryKey As string</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sTableName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1941065727</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sTableName As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sTableName As string</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sPrimaryKey</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>string</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sTableName</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>string</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="583761459">
 <ObjName>FieldOpt</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2082918399</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(sFieldName as string)</SourceLine>
   <SourceLine>m_sFieldName = sFieldName</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sFieldName as string</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>FieldName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>789620735</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function FieldName() As String</SourceLine>
   <SourceLine>return m_sFieldName</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>ForeignKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1727508479</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ForeignKey() As TP_ActiveRecord.FieldOpt</SourceLine>
   <SourceLine>m_bForeignKey = true</SourceLine>
   <SourceLine>return self</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.FieldOpt</ItemResult>
 </Method>
 <Method>
  <ItemName>Ignored</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>259393535</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Ignored() As TP_ActiveRecord.FieldOpt</SourceLine>
   <SourceLine>m_bIgnored = true</SourceLine>
   <SourceLine>return self</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>TP_ActiveRecord.FieldOpt</ItemResult>
 </Method>
 <Method>
  <ItemName>IsForeignKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>819169279</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsForeignKey() As Boolean</SourceLine>
   <SourceLine>return m_bForeignKey</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>IsIgnored</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1070786559</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsIgnored() As Boolean</SourceLine>
   <SourceLine>return m_bIgnored</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Property>
  <ItemName>m_bForeignKey</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1861910527</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_bForeignKey As boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_bForeignKey As boolean</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_bIgnored</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2143338495</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_bIgnored As Boolean</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_bIgnored As Boolean</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_sFieldName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1329850367</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_sFieldName As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_sFieldName As string</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1845259045">
 <ObjName>CubeSQLDatabaseAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>268642303</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>'If you are not connecting to CubeSQLServer and do not have the CubeSQLServer plugin delete this class (cubeSQLDatabaseAdapter)</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>if m_iTransactionCt=0 and not db.AutoCommit then</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>SQLExecute( "BEGIN" )</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>BindValues</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>307544063</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function BindValues(oStmt as Object, oRecord as TP_ActiveRecord.Base, aroField() as TP_ActiveRecord.P.FieldInfo) As Dictionary</SourceLine>
   <SourceLine>// Overriding the parent class ...</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var stmt as cubeSQLVM = cubeSQLVM(oStmt)</SourceLine>
   <SourceLine>Var dictFieldValue as new Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for i as integer = 0 to aroField.LastIndex</SourceLine>
   <SourceLine>Var oField as TP_ActiveRecord.P.FieldInfo = aroField(i)</SourceLine>
   <SourceLine>Var pi as Introspection.PropertyInfo = oField.piFieldProperty</SourceLine>
   <SourceLine>Var v as Variant = pi.Value(oRecord)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iDBType as Integer</SourceLine>
   <SourceLine>select case aroField(i).enFieldType</SourceLine>
   <SourceLine>case DBType.DInteger</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DSmallInt</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>case DBType.DDouble</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case DBType.DDate</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTime</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DTimestamp</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DBoolean</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BOOLEAN</SourceLine>
   <SourceLine>case DBType.DBlob</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_BLOB</SourceLine>
   <SourceLine>case DBType.DText</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>case DBType.DInt64</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case DBType.DFloat</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>case dbType.dCurrency</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>case else</SourceLine>
   <SourceLine>break 'unsupported type</SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oField.IsKey and (v.IntegerValue &lt; 1 or v.StringValue = "" or v.StringValue = "0") then</SourceLine>
   <SourceLine>'if the field is a key and it's 0 or less, then set it to NULL</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_NULL</SourceLine>
   <SourceLine>elseif pi.PropertyType.Name="Date" or _</SourceLine>
   <SourceLine>(pi.PropertyType.Name="Variant" and v.Type=Variant.TypeDate) then</SourceLine>
   <SourceLine>Var dt as DateTime = v.DateTimeValue</SourceLine>
   <SourceLine>if dt=nil then</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_NULL</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var dt1 as new Date</SourceLine>
   <SourceLine>dt1.GMTOffset = dt.GMTOffset</SourceLine>
   <SourceLine>dt1.TotalSeconds = dt.TotalSeconds</SourceLine>
   <SourceLine>v = dt1 'copied for the saved value</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dt2 as new Date</SourceLine>
   <SourceLine>dt2.GMTOffset = dt.GMTOffset</SourceLine>
   <SourceLine>dt2.TotalSeconds = dt.TotalSeconds</SourceLine>
   <SourceLine>dt2.GMTOffset = 0</SourceLine>
   <SourceLine>dt = dt2</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oField.enFieldType=TP_ActiveRecord.DBType.DDate then</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>elseif oField.enFieldType=TP_ActiveRecord.DBType.DTimestamp then</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>elseif pi.PropertyType.Name="Double" and _</SourceLine>
   <SourceLine>v.DoubleValue = TP_ActiveRecord.kDoubleNullSentinal then</SourceLine>
   <SourceLine>iDBType = SQLitePreparedStatement.SQLITE_NULL</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>// stmt.Bind(i, v)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>dictFieldValue.Value(pi.Name) = v</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>select case iDBType</SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_INTEGER</SourceLine>
   <SourceLine>stmt.BindInt(i + 1, v.IntegerValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_DOUBLE</SourceLine>
   <SourceLine>stmt.BindDouble(i + 1, v.DoubleValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_TEXT</SourceLine>
   <SourceLine>stmt.BindText(i + 1, v.StringValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_BOOLEAN</SourceLine>
   <SourceLine>stmt.BindInt(i + 1, v.IntegerValue)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_BLOB</SourceLine>
   <SourceLine>stmt.BindBlob(i + 1, v)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>case SQLitePreparedStatement.SQLITE_INT64</SourceLine>
   <SourceLine>stmt.BindInt64(i + 1, v.Int64Value)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end select</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return dictFieldValue</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused aroField</SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine>#pragma unused oStmt</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oStmt as Object, oRecord as TP_ActiveRecord.Base, aroField() as TP_ActiveRecord.P.FieldInfo</ItemParams>
  <ItemResult>Dictionary</ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>44306431</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>If m_iTransactionCt=0 Then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch exCaught As RuntimeException</SourceLine>
   <SourceLine>Var ex As New RuntimeException</SourceLine>
   <SourceLine>ex.Message = exCaught.Message</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise ex</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>751503359</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting to CubeSQL</SourceLine>
   <SourceLine>// and do not have the CubeSQL Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>Var ex as new UnsupportedOperationException</SourceLine>
   <SourceLine>ex.Message = "CubeSQL is not enabled"</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>58073087</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>DeleteRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1099296767</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub DeleteRecord(oRecord as TP_ActiveRecord.Base)</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "DELETE FROM " + oTableInfo.sTableName + _</SourceLine>
   <SourceLine>" WHERE " + oTableInfo.sPrimaryKey + "=?1"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var stmt as CubeSQLVM</SourceLine>
   <SourceLine>stmt = db.VMPrepare(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oRecord.GUID &lt;&gt; "" then</SourceLine>
   <SourceLine>stmt.BindText(1, oRecord.GUID)</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>stmt.BindInt64(1, oRecord.ID)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>stmt.VMExecute</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2120552447</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>return db.LastRowID</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>500144127</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>// Overriding the parent class ...</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var i as integer</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>i = i + 1</SourceLine>
   <SourceLine>arsPlaceholder.Add("?" + str(i))</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>sql = "INSERT INTO " + oTableInfo.sTableName</SourceLine>
   <SourceLine>sql = sql + "(" + String.FromArray(arsField, ",") + ")"</SourceLine>
   <SourceLine>sql = sql + " VALUES "</SourceLine>
   <SourceLine>sql = sql + "(" + String.FromArray(arsPlaceholder, ",") + ")"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var stmt as CubeSQLVM</SourceLine>
   <SourceLine>stmt = db.VMPrepare(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>dictFieldValue = BindValues(stmt, oRecord, aroField)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>stmt.VMExecute</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iRowID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("select "</SourceLine>
   <SourceLine>arsSQL.Add(sPK</SourceLine>
   <SourceLine>arsSQL.Add("From "</SourceLine>
   <SourceLine>arsSQL.Add(oTableInfo.sTableName</SourceLine>
   <SourceLine>arsSQL.Add("Where RowID = "</SourceLine>
   <SourceLine>arsSQL.Add(str(iRowID)</SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine>Var rs as RowSet = db.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sRecordID as string = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRowID</SourceLine>
   <SourceLine>oRecord.id = iRowID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused dictSavedPropertyValue</SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>974964735</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>SelectRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>280414207</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SelectRecord(oRecord as TP_ActiveRecord.Base, iRecordID as Int64) As RowSet</SourceLine>
   <SourceLine>// Overriding the parent class ...</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "SELECT * FROM " + oTableInfo.sTableName + _</SourceLine>
   <SourceLine>" WHERE " + oTableInfo.sPrimaryKey + "=?1"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var stmt as CubeSQLVM</SourceLine>
   <SourceLine>stmt = db.VMPrepare(sql)</SourceLine>
   <SourceLine>// stmt.BindType(0, SQLitePreparedStatement.SQLITE_INT64)</SourceLine>
   <SourceLine>stmt.BindInt64(1, iRecordID)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = stmt.VMSelect</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused iRecordID</SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, iRecordID as Int64</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>SelectRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>316260351</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SelectRecord(oRecord as TP_ActiveRecord.Base, sID as string) As RowSet</SourceLine>
   <SourceLine>// Overriding the parent class ...</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "SELECT * FROM " + oTableInfo.sTableName + _</SourceLine>
   <SourceLine>" WHERE " + oTableInfo.sPrimaryKey + "=?1"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var stmt as CubeSQLVM</SourceLine>
   <SourceLine>stmt = db.VMPrepare(sql)</SourceLine>
   <SourceLine>stmt.BindText(1, sID)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs = stmt.VMSelect</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine>#pragma unused sID</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, sID as string</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>UpdateRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1771409407</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub UpdateRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>// Overriding the parent class ...</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>Var db as CubeSQLServer = CubeSQLServer(m_db)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var oPrimaryKeyField as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var i as integer</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>oPrimaryKeyField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>i = i + 1</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName + "=?" + str(i))</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>sql = "UPDATE " + oTableInfo.sTableName + " SET "</SourceLine>
   <SourceLine>sql = sql + String.FromArray(arsField, ",")</SourceLine>
   <SourceLine>sql = sql + " WHERE " + oTableInfo.sPrimaryKey + "=?"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var stmt as CubeSQLVM</SourceLine>
   <SourceLine>stmt = db.VMPrepare(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>aroField.Add(oPrimaryKeyField)</SourceLine>
   <SourceLine>dictFieldValue = me.BindValues(stmt, oRecord, aroField)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>stmt.VMExecute</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused dictSavedPropertyValue</SourceLine>
   <SourceLine>#pragma unused oRecord</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1071056895</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>879071231</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1573558723">
 <ObjName>ValidationErrors</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Append</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1492504575</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Append(sMessage as string)</SourceLine>
   <SourceLine>m_arsError.Add( sMessage )</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sMessage as string</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Clear</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>425144319</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Clear()</SourceLine>
   <SourceLine>m_arsError.ResizeTo(-1)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Error</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2033909759</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Error(index as Integer) As string</SourceLine>
   <SourceLine>return m_arsError(index)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>index as Integer</ItemParams>
  <ItemResult>string</ItemResult>
 </Method>
 <Method>
  <ItemName>ErrorCount</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>169799679</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ErrorCount() As integer</SourceLine>
   <SourceLine>return m_arsError.LastIndex + 1</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>integer</ItemResult>
 </Method>
 <Property>
  <ItemName>m_arsError()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>612237311</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_arsError() As string</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_arsError() As string</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1809731218">
 <ObjName>MSSQLServerAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>791271423</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>' try</SourceLine>
   <SourceLine>' m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>' catch ex as RuntimeException</SourceLine>
   <SourceLine>' 'ignore this one</SourceLine>
   <SourceLine>' end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Db.BeginTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>189003775</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>374122495</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting to MS SQL Server</SourceLine>
   <SourceLine>// and do not have the MSSQLServerDatabase Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer</SourceLine>
   <SourceLine>Var db as MSSQLServerDatabase = MSSQLServerDatabase(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#pragma unused oDb</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1368410111</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1325371391</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>rs = SQLSelect("SELECT @@IDENTITY;")</SourceLine>
   <SourceLine>return rs.ColumnAt(0).Int64Value</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1666789375</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arssql.Add("OUTPUT inserted." + sPK)</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' Raise New TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var rs as RowSet = db.SelectSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var sRecordID as string = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>sRecordID = sRecordID.ReplaceAll("{", "")</SourceLine>
   <SourceLine>sRecordID = sRecordID.ReplaceAll("}", "")</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var iRecordID as Int64 = rs.Column(sPK).Int64Value</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine>oRecord.id = iRecordID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1385889791</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1753886719</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1566996479</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="755687739">
 <ObjName>MySQLCommunityServerAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1291651071</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>SQLExecute( "START TRANSACTION" )</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1073096703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>519426047</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting to MySQL</SourceLine>
   <SourceLine>// and do not have the MySQLCommunityServer Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>Var db as MySQLCommunityServer = MySQLCommunityServer(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1390598143</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1093804031</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>Return MySQLCommunityServer(m_db).LastInsertedRowID</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1272016895</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' Raise New TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var rs as RowSet = db.SelectSQL("Select @last_uuid as guid_id")</SourceLine>
   <SourceLine>Var sRecordID as string = rs.Column("guid_id").StringValue</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var iRecordID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine>oRecord.ID = iRecordID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1163313151</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>272875519</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1006571519</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1376161989">
 <ObjName>PostgreSQLDatabaseAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1819418623</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>SQLExecute( "START TRANSACTION" )</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>977385471</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1317967871</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting to PostgreSQL</SourceLine>
   <SourceLine>// and do not have the PostgreSQLDatabase Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase</SourceLine>
   <SourceLine>Var db as PostgreSQLDatabase = PostgreSQLDatabase(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1191585791</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>417798143</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>rs = SQLSelect("SELECT LASTVAL();")</SourceLine>
   <SourceLine>return rs.ColumnAt(0).Int64Value</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>676642815</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("$" + str(arsPlaceholder.LastIndex + 2) )</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ") RETURNING " + oTableInfo.sPrimaryKey)</SourceLine>
   <SourceLine>sql = String.FromArray(arsSQL,"")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt As PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var rs As RowSet = DB.SelectSQL(sql, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var rs As RowSet = stmt.SQLSelect</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var sRecordID As String = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var iRecordID as Int64 = rs.Column(sPK).Int64Value</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine>oRecord.id = iRecordID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>648663039</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>UpdateRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>201074687</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub UpdateRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var oPrimaryKeyField as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>oPrimaryKeyField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName + "=$" + str(arsField.LastIndex + 2) )</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>sql = "UPDATE " + oTableInfo.sTableName + " SET "</SourceLine>
   <SourceLine>sql = sql + String.FromArray(arsField, ",")</SourceLine>
   <SourceLine>sql = sql + " WHERE " + oTableInfo.sPrimaryKey + "=$" + str(arsField.LastIndex + 2)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare(sql)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>aroField.Add(oPrimaryKeyField)</SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sql, arovalues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2069084159</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1591238655</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1732490146">
 <ObjName>SQLiteDatabaseAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1137586175</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>If m_iTransactionCt=0 Then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>#Pragma BreakOnExceptions False</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Db.BeginTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>442322943</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1064429567</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>Var db as SQLiteDatabase = SQLiteDatabase(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>#pragma unused oDb</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>882204671</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>730974207</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>return SQLiteDatabase(m_db).LastRowID</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>692506623</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() As TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt As PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' If db.Error Then</SourceLine>
   <SourceLine>' Raise New TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' End If</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iRowID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>arsSQL.ResizeTo(-1)</SourceLine>
   <SourceLine>arsSQL.Add("SELECT ")</SourceLine>
   <SourceLine>arsSQL.Add(sPK)</SourceLine>
   <SourceLine>arsSQL.Add("FROM ")</SourceLine>
   <SourceLine>arsSQL.Add(oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("WHERE RowID = ")</SourceLine>
   <SourceLine>arsSQL.Add(str(iRowID))</SourceLine>
   <SourceLine>sSQL = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine>Var rs as RowSet = db.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sRecordID as string = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRowID</SourceLine>
   <SourceLine>oRecord.id = iRowID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1526061055</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1835382783</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>91889663</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1300199810">
 <ObjName>VSQLiteDatabaseAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1936652287</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>SQLExecute( "BEGIN" )</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>189460479</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>320141311</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var db as VSqliteDataBase = VSQLiteDatabase(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1842978815</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>339437567</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>return VSQLiteDatabase(m_db).LastRowID</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1917497343</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine>var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iRowID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>arsSQL.ResizeTo(-1)</SourceLine>
   <SourceLine>arsSQL.Add("SELECT ")</SourceLine>
   <SourceLine>arsSQL.Add(sPK)</SourceLine>
   <SourceLine>arsSQL.Add("FROM ")</SourceLine>
   <SourceLine>arsSQL.Add(oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("WHERE RowID = ")</SourceLine>
   <SourceLine>arsSQL.Add(str(iRowID))</SourceLine>
   <SourceLine>sSQL = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine>Var rs as RowSet = db.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sRecordID as string = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRowID</SourceLine>
   <SourceLine>oRecord.id = iRowID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1732835327</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>600254463</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1041774591</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="540361462">
 <ObjName>DatabaseAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1802278911</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>break //Should be called by the Database Adapter Subclass</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>BindId</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1226747903</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BindId(stmt as PreparedSQLStatement, i as integer, id as Int64)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>if db isa SQLiteDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, SQLitePreparedStatement.SQLITE_INT64)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>if db isa MySQLCommunityServer then</SourceLine>
   <SourceLine>stmt.BindType(i, MySQLPreparedStatement.MYSQL_TYPE_LONGLONG)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase</SourceLine>
   <SourceLine>if db isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>//PostgreSQL doesn't do binding the same way</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer</SourceLine>
   <SourceLine>if db isa MSSQLServerDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_INT)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC</SourceLine>
   <SourceLine>if db isa ODBCDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, ODBCPreparedStatement.ODBC_TYPE_BIGINT)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#If TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>if db isa CubeSQLServer then</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>if db isa VSQLiteDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, SQLitePreparedStatement.SQLITE_INT64)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>stmt.Bind(i, id)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>stmt as PreparedSQLStatement, i as integer, id as Int64</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>BindId</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2039695359</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BindId(stmt as PreparedSQLStatement, i as integer, sID as String)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase and RBVersion&gt;=2013</SourceLine>
   <SourceLine>if db isa SQLiteDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, SQLitePreparedStatement.SQLITE_TEXT)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer</SourceLine>
   <SourceLine>if db isa MySQLCommunityServer then</SourceLine>
   <SourceLine>stmt.BindType(i, MySQLPreparedStatement.MYSQL_TYPE_STRING)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase</SourceLine>
   <SourceLine>if db isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>//PostgreSQL doesn't do binding the same way</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer</SourceLine>
   <SourceLine>if db isa MSSQLServerDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, MSSQLServerPreparedStatement.MSSQLSERVER_TYPE_STRING)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC</SourceLine>
   <SourceLine>if db isa ODBCDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, ODBCPreparedStatement.ODBC_TYPE_STRING)</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#If TP_ActiveRecord.kConfigUseCubeDatabase</SourceLine>
   <SourceLine>if db isa CubeSQLServer then</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>if db isa VSQLiteDatabase then</SourceLine>
   <SourceLine>stmt.BindType(i, SQLitePreparedStatement.SQLITE_TEXT)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>stmt.Bind(i, sID)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>stmt as PreparedSQLStatement, i as integer, sID as String</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>BindValues</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2133499903</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function BindValues(oRecord as TP_ActiveRecord.Base, aroField() as TP_ActiveRecord.P.FieldInfo, aroValues() as variant) As Dictionary</SourceLine>
   <SourceLine>Var dictFieldValue as new Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>For i As Integer = 0 To aroField.LastIndex</SourceLine>
   <SourceLine>Var oField As TP_ActiveRecord.P.FieldInfo = aroField(i)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var pi As Introspection.PropertyInfo = oField.piFieldProperty</SourceLine>
   <SourceLine>//BKS:  This currently fails if the property is a DateTime.</SourceLine>
   <SourceLine>Var v As Variant = pi.Value(oRecord)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Select Case db</SourceLine>
   <SourceLine>Case Nil</SourceLine>
   <SourceLine>'empty. This just let's it compile if someone turns off all the constants</SourceLine>
   <SourceLine>End Select</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oField.IsKey and (v.IntegerValue &lt; 1 or v.StringValue = "" or v.StringValue = "0") then</SourceLine>
   <SourceLine>// if the field is a key and it's 0 or less, then set it to NULL</SourceLine>
   <SourceLine>// If this inserts as 0, that's Xojo's problem.</SourceLine>
   <SourceLine>aroValues.Add(nil)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Elseif pi.PropertyType.Name="Date" Or (pi.PropertyType.Name="Variant" And v.Type=Variant.TypeDate) Then</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dt As DateTime = v.DateTimeValue</SourceLine>
   <SourceLine>If dt=Nil Then</SourceLine>
   <SourceLine>aroValues.Add(Nil)</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>Var dt1 As New DateTime(dt.SecondsFrom1970, dt.Timezone)</SourceLine>
   <SourceLine>v = dt1 'copied for the saved value</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var tz As New TimeZone(0)</SourceLine>
   <SourceLine>Var dt2 As New DateTime(dt.SecondsFrom1970, tz)</SourceLine>
   <SourceLine>dt = dt2</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>If oField.enFieldType=TP_ActiveRecord.DBType.DDate Then</SourceLine>
   <SourceLine>aroValues.Add(dt.SQLDate)</SourceLine>
   <SourceLine>Elseif oField.enFieldType=TP_ActiveRecord.DBType.DTimestamp Then</SourceLine>
   <SourceLine>aroValues.Add(dt.SQLDateTime)</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>aroValues.Add(dt.SQLDateTime)</SourceLine>
   <SourceLine>End If</SourceLine>
   <SourceLine>End If</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Elseif pi.PropertyType.Name="Double" And v.DoubleValue = TP_ActiveRecord.kDoubleNullSentinal Then</SourceLine>
   <SourceLine>aroValues.Add(nil)</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>aroValues.Add(v)</SourceLine>
   <SourceLine>End If</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>dictFieldValue.Value(pi.Name) = v</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Return dictFieldValue</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, aroField() as TP_ActiveRecord.P.FieldInfo, aroValues() as variant</ItemParams>
  <ItemResult>Dictionary</ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1553444863</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>break //Should be called by the Database Adapter Subclass</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1541523455</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor()</SourceLine>
   <SourceLine>'Empty</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>751695871</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert( false, "needs to be implemented in subclass" )</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>DeleteRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>195244031</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub DeleteRecord(oRecord as TP_ActiveRecord.Base)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "DELETE FROM " + oTableInfo.sTableName + _</SourceLine>
   <SourceLine>" WHERE " + oTableInfo.sPrimaryKey</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase</SourceLine>
   <SourceLine>if db isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>sql = sql  + "=$1"</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>sql = sql  + "=?"</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>sql = sql  + "=?"</SourceLine>
   <SourceLine>#EndIf</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>If oRecord.GUID &lt;&gt; "" Then</SourceLine>
   <SourceLine>db.ExecuteSQL(sql, oRecord.GUID)</SourceLine>
   <SourceLine>Else</SourceLine>
   <SourceLine>db.ExecuteSQL(sql, oRecord.ID)</SourceLine>
   <SourceLine>End If</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare(sql)</SourceLine>
   <SourceLine>' if oRecord.GUID &lt;&gt; "" then</SourceLine>
   <SourceLine>' BindId(stmt, 0, oRecord.GUID)</SourceLine>
   <SourceLine>' else</SourceLine>
   <SourceLine>' BindId(stmt, 0, oRecord.ID)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine>' </SourceLine>
   <SourceLine>' </SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' If db.Error Then</SourceLine>
   <SourceLine>' Raise New TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1438783487</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert( false, "needs to be implemented in subclass" )</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>HasTable</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>163096575</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function HasTable(sTableName as String) As boolean</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>rs = Db.Tables</SourceLine>
   <SourceLine>while not rs.AfterLastRow</SourceLine>
   <SourceLine>if rs.ColumnAt(0).StringValue = sTableName then</SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine>wend</SourceLine>
   <SourceLine>return false</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sTableName as String</ItemParams>
  <ItemResult>boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>463861759</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, arovalues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iRecordID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>310315007</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>break //Should be called by the Database Adapter Subclass</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>SelectList</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>676861951</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SelectList(sTable as string, sCondition as string = "", sOrder as string = "") As RowSet</SourceLine>
   <SourceLine>Var sSQL as string = "SELECT * FROM " + sTable + " "</SourceLine>
   <SourceLine>if sCondition&lt;&gt;"" then</SourceLine>
   <SourceLine>sSQL = sSQL + "WHERE " + sCondition</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if sOrder&lt;&gt;"" then</SourceLine>
   <SourceLine>sSQL = sSQL + " ORDER BY " + sOrder</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>sSQL = sSQL + ";"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return SQLSelect(sSQL)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sTable as string, sCondition as string = "", sOrder as string = ""</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>SelectRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1137647615</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SelectRecord(oRecord as TP_ActiveRecord.Base, iRecordID as integer) As RowSet</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "SELECT * FROM " + oTableInfo.sTableName + " WHERE " + oTableInfo.sPrimaryKey + "=?"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var rs As RowSet = DB.SelectSQL(sql, iRecordID)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare(sql)</SourceLine>
   <SourceLine>' BindId(stmt, 0, iRecordID)</SourceLine>
   <SourceLine>' </SourceLine>
   <SourceLine>' rs = stmt.SQLSelect</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, iRecordID as integer</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>SelectRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>717807615</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SelectRecord(oRecord as TP_ActiveRecord.Base, sRecorID as string) As RowSet</SourceLine>
   <SourceLine>Var sql as string</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>sql = "SELECT * FROM " + oTableInfo.sTableName + " WHERE " + oTableInfo.sPrimaryKey + "=?"</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var rs As RowSet = DB.SelectSQL(sql, sRecorID)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare(sql)</SourceLine>
   <SourceLine>' BindId(stmt, 0, sRecorID)</SourceLine>
   <SourceLine>' </SourceLine>
   <SourceLine>' rs = stmt.SQLSelect</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, sRecorID as string</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>SQLExecute</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1069127679</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub SQLExecute(sql as String)</SourceLine>
   <SourceLine>db.ExecuteSQL( sql )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sql as String</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>SQLSelect</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1064194047</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function SQLSelect(sql as String) As RowSet</SourceLine>
   <SourceLine>Var rs As RowSet = db.SelectSQL( sql )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sql as String</ItemParams>
  <ItemResult>RowSet</ItemResult>
 </Method>
 <Method>
  <ItemName>UpdateRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>485126143</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub UpdateRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo As TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var oPrimaryKeyField as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>oPrimaryKeyField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName + "=?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("UPDATE " + oTableInfo.sTableName + " SET ")</SourceLine>
   <SourceLine>arsSQL.Add(String.FromArray(arsField, ","))</SourceLine>
   <SourceLine>arsSQL.Add(" WHERE " + oTableInfo.sPrimaryKey + "=?")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL As String = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine>' Var stmt As PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( String.FromArray(arsSQL, " ") )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>aroField.Add(oPrimaryKeyField)</SourceLine>
   <SourceLine>var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1817862288">
 <ObjName>ActiveRecordException</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>RuntimeException</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>145965055</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(sMessage as string)</SourceLine>
   <SourceLine>me.Message = sMessage</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sMessage as string</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Reason</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Text</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>ErrorNumber</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Message</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1057624380">
 <ObjName>View</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2126917631</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor()</SourceLine>
   <SourceLine>'Empty</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>264452095</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(rs as RowSet)</SourceLine>
   <SourceLine>ReadRecord(rs)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1212606463</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return GetDatabaseAdapter.Db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetDatabaseAdapter</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1003595775</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDatabaseAdapter() As DatabaseAdapter</SourceLine>
   <SourceLine>return GetContext.ConnectionAdapter_Get(Introspection.GetType(self))</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>DatabaseAdapter</ItemResult>
 </Method>
 <Method>
  <ItemName>GetTableName</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>840722431</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetTableName() As String</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(self) )</SourceLine>
   <SourceLine>Return oTableInfo.sTableName</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>ID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2116587519</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ID() As integer</SourceLine>
   <SourceLine>//PROGRAMMER NOTE!</SourceLine>
   <SourceLine>//You are here because you've tried to use the ID of a VIEW</SourceLine>
   <SourceLine>//There is no ID in a view in ActiveRecord (or at least one that you can do anything with).</SourceLine>
   <SourceLine>//Check your stack and see where you came from.</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>integer</ItemResult>
 </Method>
 <Method>
  <ItemName>ReadRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1347221503</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ReadRecord(rs as RowSet)</SourceLine>
   <SourceLine>'Read current record out of rs into properties</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(self) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>ReadRecord( rs, oTableInfo )</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>ReadRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>246970367</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub ReadRecord(rs as RowSet, oTableInfo as TP_ActiveRecord.P.TableInfo)</SourceLine>
   <SourceLine>'Read current record out of rs into properties</SourceLine>
   <SourceLine>Var dictFieldValue as new Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for each oFieldInfo as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>Var oField as DatabaseColumn = rs.Column( oFieldInfo.sFieldName )</SourceLine>
   <SourceLine>Var pi as Introspection.PropertyInfo = oFieldInfo.piFieldProperty</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oField is nil then</SourceLine>
   <SourceLine>TP_ActiveRecord.Assert( false, _</SourceLine>
   <SourceLine>"A field needed to populate this record wasn't provided: " + _</SourceLine>
   <SourceLine>oFieldInfo.sFieldName )</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var vProperty as Variant</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if pi.PropertyType.Name = "Double" then</SourceLine>
   <SourceLine>if oField.Value=nil then</SourceLine>
   <SourceLine>vProperty = TP_ActiveRecord.kDoubleNullSentinal</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>vProperty = oField.Value</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>elseif pi.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>Var s as string = oField.StringValue</SourceLine>
   <SourceLine>if Encoding(s) is nil then</SourceLine>
   <SourceLine>s = DefineEncoding(s, Encodings.UTF8)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>vProperty = s</SourceLine>
   <SourceLine>elseif pi.PropertyType.IsPrimitive then</SourceLine>
   <SourceLine>vProperty = oField.Value</SourceLine>
   <SourceLine>Elseif pi.PropertyType = GetTypeInfo(DateTime) Then</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var v as Variant = oField.Value</SourceLine>
   <SourceLine>if v = nil or v = "" then</SourceLine>
   <SourceLine>vProperty=nil</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>Var dt As DateTime</SourceLine>
   <SourceLine>#Pragma BreakOnExceptions False</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>dt = DateTime.FromString(v.StringValue)</SourceLine>
   <SourceLine>Catch e As UnsupportedFormatException</SourceLine>
   <SourceLine>dt = DateTime.FromString("2000-01-01 00:00:00.000")</SourceLine>
   <SourceLine>End Try</SourceLine>
   <SourceLine>vProperty=dt</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>vProperty= oField.Value</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>pi.Value(self) = vProperty</SourceLine>
   <SourceLine>dictFieldValue.Value(pi.Name) = vProperty</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>rs as RowSet, oTableInfo as TP_ActiveRecord.P.TableInfo</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="932341759">
 <ObjName>ODBCServerAdapter</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1999759359</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>m_Db.CommitTransaction 'commit the auto transaction</SourceLine>
   <SourceLine>catch ex as RuntimeException</SourceLine>
   <SourceLine>'ignore this one</SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Db.BeginTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1848870911</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Try</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine>Catch err As RuntimeException</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>Raise Err</SourceLine>
   <SourceLine>End</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>345288703</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting with ODBC</SourceLine>
   <SourceLine>// and do not have the ODBCDatabase Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC</SourceLine>
   <SourceLine>Var db as ODBCDatabase = ODBCDatabase(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>559663103</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1627025407</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>//Note that this WILL change depending upon the database you're connecting to via ODBC.</SourceLine>
   <SourceLine>Var rs as RowSet</SourceLine>
   <SourceLine>rs = SQLSelect("SELECT @@IDENTITY;")</SourceLine>
   <SourceLine>return rs.ColumnAt(0).Int64Value</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1109012479</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>Var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsField() as string</SourceLine>
   <SourceLine>Var arsPlaceholder() as string</SourceLine>
   <SourceLine>Var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>Var sPK as string</SourceLine>
   <SourceLine>Var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' Var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>' stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>db.ExecuteSQL(sSQL, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>' stmt.SQLExecute</SourceLine>
   <SourceLine>' if db.Error then</SourceLine>
   <SourceLine>' raise new TP_ActiveRecord.DatabaseException(db)</SourceLine>
   <SourceLine>' end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>'AR for ODBC does not support text. Feel free to modifiy this method to suit your needs.</SourceLine>
   <SourceLine>break </SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var iRecordID as Int64 = GetLastInsertID</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1918361599</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>db.RollbackTransaction</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1162719231</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>336775167</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1573750783">
 <ObjName>AssertionFailedException</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>ActiveRecordException</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Folder" ID="1653567487">
 <ObjName>Demo App</ObjName>
 <ObjContainerID>0</ObjContainerID>
</block>
<block type="Module" ID="375033321">
 <ObjName>App</ObjName>
 <ObjContainerID>1653567487</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>Application</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <IsApplicationObject>1</IsApplicationObject>
 <Compatibility></Compatibility>
 <HookInstance>
  <ItemName>Close</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1671847935</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Close()</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>if DataFile.db &lt;&gt; nil then</SourceLine>
   <SourceLine>DataFile.db.Close()</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Valentina.ShutDownClient()</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <HookInstance>
  <ItemName>Open</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>386535423</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Open()</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseVSQLiteDatabase</SourceLine>
   <SourceLine>Valentina.InitClient()</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if DebugBuild then</SourceLine>
   <SourceLine>Valentina.DebugLevel = EVDebugLevel.kLogParams</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>Valentina.DebugLevel = EVDebugLevel.kLogNothing</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Connect to the database</SourceLine>
   <SourceLine>call DataFile.DB</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <MenuHandler>
  <ItemName>AboutActiveRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>990181375</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function AboutActiveRecord() As Boolean Handles AboutActiveRecord.Action</SourceLine>
   <SourceLine>MessageBox("ActiveRecord for Xojo" + EndOfLine + EndOfLine + _</SourceLine>
   <SourceLine>"Release " + Format(TP_ActiveRecord.kVersion, "####.00"))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
 </MenuHandler>
 <MenuHandler>
  <ItemName>ARGenHomePage</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1982961663</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ARGenHomePage() As Boolean Handles ARGenHomePage.Action</SourceLine>
   <SourceLine>ShowURL("https://strawberrysw.com/argen")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
 </MenuHandler>
 <MenuHandler>
  <ItemName>ARHomePage</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>778266623</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function ARHomePage() As Boolean Handles ARHomePage.Action</SourceLine>
   <SourceLine>ShowURL("https://strawberrysw.com/activerecord")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
 </MenuHandler>
 <MenuHandler>
  <ItemName>HelpStrawberryWebsite</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1990172671</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function HelpStrawberryWebsite() As Boolean Handles HelpStrawberryWebsite.Action</SourceLine>
   <SourceLine>ShowURL("https://strawberrysw.com")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return true</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
 </MenuHandler>
 <PropertyVal Name="MenuBar">1408456886</PropertyVal>
 <ViewBehavior>
 </ViewBehavior>
 <Constant>
  <ItemName>kEditClear</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1614047231</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>&amp;Delete</ItemDef>
  <ItemFlags>0</ItemFlags>
  <ConstantInstance>
   <ItemPlatform>2</ItemPlatform>
   <ItemLanguage>0</ItemLanguage>
   <ItemDef>&amp;Delete</ItemDef>
  </ConstantInstance>
  <ConstantInstance>
   <ItemPlatform>5</ItemPlatform>
   <ItemLanguage>0</ItemLanguage>
   <ItemDef>&amp;Delete</ItemDef>
  </ConstantInstance>
 </Constant>
 <Constant>
  <ItemName>kFileQuit</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>654028799</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>&amp;Quit</ItemDef>
  <ItemFlags>0</ItemFlags>
  <ConstantInstance>
   <ItemPlatform>2</ItemPlatform>
   <ItemLanguage>0</ItemLanguage>
   <ItemDef>E&amp;xit</ItemDef>
  </ConstantInstance>
 </Constant>
 <Constant>
  <ItemName>kFileQuitShortcut</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2058504191</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef></ItemDef>
  <ItemFlags>0</ItemFlags>
  <ConstantInstance>
   <ItemPlatform>1</ItemPlatform>
   <ItemLanguage>0</ItemLanguage>
   <ItemDef>Cmd+Q</ItemDef>
  </ConstantInstance>
  <ConstantInstance>
   <ItemPlatform>0</ItemPlatform>
   <ItemLanguage>0</ItemLanguage>
   <ItemDef>Ctrl+Q</ItemDef>
  </ConstantInstance>
 </Constant>
</block>
<block type="Menu" ID="1408456886">
 <ObjName>MenuBar1</ObjName>
 <ObjContainerID>1653567487</ObjContainerID>
 <MenuItem>
  <ItemSpecialMenu>0</ItemSpecialMenu>
  <ItemName>FileMenu</ItemName>
  <ItemText>&amp;File</ItemText>
  <ItemIndex>-2147483648</ItemIndex>
  <ItemShortcut></ItemShortcut>
  <MenuAutoEnable>1</MenuAutoEnable>
  <TextEncoding>134217984</TextEncoding>
  <MenuItemVisible>1</MenuItemVisible>
  <ItemFlags>0</ItemFlags>
  <ObjName>FileMenu</ObjName>
  <Superclass>MenuItem</Superclass>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>FileQuit</ItemName>
   <ItemText>#App.kFileQuit</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>#App.kFileQuitShortcut</ItemShortcut>
   <MenuShortcut>#App.kFileQuitShortcut</MenuShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>FileQuit</ObjName>
   <Superclass>QuitMenuItem</Superclass>
  </MenuItem>
 </MenuItem>
 <MenuItem>
  <ItemSpecialMenu>0</ItemSpecialMenu>
  <ItemName>EditMenu</ItemName>
  <ItemText>&amp;Edit</ItemText>
  <ItemIndex>-2147483648</ItemIndex>
  <ItemShortcut></ItemShortcut>
  <MenuAutoEnable>1</MenuAutoEnable>
  <TextEncoding>134217984</TextEncoding>
  <MenuItemVisible>1</MenuItemVisible>
  <ItemFlags>0</ItemFlags>
  <ObjName>EditMenu</ObjName>
  <Superclass>MenuItem</Superclass>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditUndo</ItemName>
   <ItemText>&amp;Undo</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>Cmd+Z</ItemShortcut>
   <MenuShortcut>Z</MenuShortcut>
   <MenuShortcutModifier>1</MenuShortcutModifier>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditUndo</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>UntitledMenu1</ItemName>
   <ItemText>-</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>UntitledMenu1</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditCut</ItemName>
   <ItemText>Cu&amp;t</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>Cmd+X</ItemShortcut>
   <MenuShortcut>X</MenuShortcut>
   <MenuShortcutModifier>1</MenuShortcutModifier>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditCut</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditCopy</ItemName>
   <ItemText>&amp;Copy</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>Cmd+C</ItemShortcut>
   <MenuShortcut>C</MenuShortcut>
   <MenuShortcutModifier>1</MenuShortcutModifier>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditCopy</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditPaste</ItemName>
   <ItemText>&amp;Paste</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>Cmd+V</ItemShortcut>
   <MenuShortcut>V</MenuShortcut>
   <MenuShortcutModifier>1</MenuShortcutModifier>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditPaste</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditClear</ItemName>
   <ItemText>#App.kEditClear</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditClear</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>UntitledMenu0</ItemName>
   <ItemText>-</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>UntitledMenu0</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>EditSelectAll</ItemName>
   <ItemText>Select &amp;All</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut>Cmd+A</ItemShortcut>
   <MenuShortcut>A</MenuShortcut>
   <MenuShortcutModifier>1</MenuShortcutModifier>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>EditSelectAll</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
 </MenuItem>
 <MenuItem>
  <ItemSpecialMenu>0</ItemSpecialMenu>
  <ItemName>HelpMenu</ItemName>
  <ItemText>Help</ItemText>
  <ItemIndex>-2147483648</ItemIndex>
  <ItemShortcut></ItemShortcut>
  <MenuAutoEnable>1</MenuAutoEnable>
  <TextEncoding>134217984</TextEncoding>
  <MenuItemVisible>1</MenuItemVisible>
  <ItemFlags>0</ItemFlags>
  <ObjName>HelpMenu</ObjName>
  <Superclass>MenuItem</Superclass>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>HelpStrawberryWebsite</ItemName>
   <ItemText>Strawberry Software Website</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>HelpStrawberryWebsite</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>ARHomePage</ItemName>
   <ItemText>ActiveRecord Home Page</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>ARHomePage</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>ARGenHomePage</ItemName>
   <ItemText>ARGen Home Page</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>ARGenHomePage</ObjName>
   <Superclass>MenuItem</Superclass>
  </MenuItem>
  <MenuItem>
   <ItemSpecialMenu>0</ItemSpecialMenu>
   <ItemName>AboutActiveRecord</ItemName>
   <ItemText>About ActiveRecord</ItemText>
   <ItemIndex>-2147483648</ItemIndex>
   <ItemShortcut></ItemShortcut>
   <MenuAutoEnable>1</MenuAutoEnable>
   <TextEncoding>134217984</TextEncoding>
   <MenuItemVisible>1</MenuItemVisible>
   <ItemFlags>0</ItemFlags>
   <ObjName>AboutActiveRecord</ObjName>
   <Superclass>ApplicationMenuItem</Superclass>
  </MenuItem>
 </MenuItem>
</block>
<block type="Module" ID="100075519">
 <ObjName>ActiveRecordClass</ObjName>
 <ObjContainerID>471158405</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>DataFile.ActiveRecordBase</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <HookInstance>
  <ItemName>AfterCreate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1220401151</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub AfterCreate()</SourceLine>
   <SourceLine>var oAudit as TP_AuditTrail.Entry = TP_AuditTrail.Entry.AuditAdd(self)</SourceLine>
   <SourceLine>'Add Additional Info here.</SourceLine>
   <SourceLine>'oAudit.srecordno = "your record number string Here"</SourceLine>
   <SourceLine>'oAudit.iparent_id = 0 'Parent Record ID here if required</SourceLine>
   <SourceLine>'oAudit.iuser_id = 0 'User ID if required.</SourceLine>
   <SourceLine>oAudit.Insert</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <HookInstance>
  <ItemName>AfterDelete</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2063855615</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub AfterDelete()</SourceLine>
   <SourceLine>if self.IsNew = false then</SourceLine>
   <SourceLine>var oAudit as TP_AuditTrail.Entry = TP_AuditTrail.Entry.AuditDelete(self)</SourceLine>
   <SourceLine>'oAudit.srecordno = "your record number string Here"</SourceLine>
   <SourceLine>'oAudit.iparent_id = 0 'Parent Record ID here if required</SourceLine>
   <SourceLine>'oAudit.iuser_id = 0 'User ID if required.</SourceLine>
   <SourceLine>oAudit.Insert</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <HookInstance>
  <ItemName>AfterUpdate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1663827967</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub AfterUpdate()</SourceLine>
   <SourceLine>// If the record hasn't been modified don't add an audit trail</SourceLine>
   <SourceLine>if me.IsModified = true then</SourceLine>
   <SourceLine>var oAudit as TP_AuditTrail.Entry = TP_AuditTrail.Entry.AuditEdit(self)</SourceLine>
   <SourceLine>'Add Additional Info here.</SourceLine>
   <SourceLine>'oAudit.srecordno = "your record number string Here"</SourceLine>
   <SourceLine>'oAudit.iparent_id = 0 'Parent Record ID here if required</SourceLine>
   <SourceLine>'oAudit.iuser_id = 0 'User ID if required.</SourceLine>
   <SourceLine>oAudit.Insert</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <HookInstance>
  <ItemName>Validate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>809426943</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Validate(oErrors as TP_ActiveRecord.ValidationErrors)</SourceLine>
   <SourceLine>// Check for errors here. Use this to prevent deletion.</SourceLine>
   <SourceLine>// Append to the oErrors object to cause validation to return false</SourceLine>
   <SourceLine>#pragma unused oErrors</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
 </HookInstance>
 <Method>
  <ItemName>BaseSQL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>182611967</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function BaseSQL(bAsCount as Boolean = false) As String</SourceLine>
   <SourceLine>var arsSQL() as String</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>arsSQL.Add("SELECT")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if bAsCount = false then</SourceLine>
   <SourceLine>arsSQL.Add("*")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>arsSQL.Add("COUNT(*) as iCount")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>arsSQL.Add("FROM t_Table")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return String.FromArray(arsSQL)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>bAsCount as Boolean = false</ItemParams>
  <ItemResult>String</ItemResult>
 </Method>
 <Method>
  <ItemName>FindByID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>921927679</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function FindByID(iID as Integer) As DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>// Use ActiveRecord Load function to get the record</SourceLine>
   <SourceLine>var oRecord as new DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>if oRecord.Load(iID) then</SourceLine>
   <SourceLine>return oRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>iID as Integer</ItemParams>
  <ItemResult>DataFile.ActiveRecordClass</ItemResult>
 </Method>
 <Method>
  <ItemName>FindByID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2011328511</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function FindByID(sID as String) As DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>// Use ActiveRecord Load function to get the record</SourceLine>
   <SourceLine>var oRecord as new DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>if oRecord.Load(sID) then</SourceLine>
   <SourceLine>return oRecord</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>sID as String</ItemParams>
  <ItemResult>DataFile.ActiveRecordClass</ItemResult>
 </Method>
 <Method>
  <ItemName>IsDuplicate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>992174079</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function IsDuplicate(sValue as String) As Boolean</SourceLine>
   <SourceLine>// Use this Method to test for duplicate records</SourceLine>
   <SourceLine>// Note: The following example is for a SQLite database and may differ for your database.</SourceLine>
   <SourceLine>// For more information see http://docs.xojo.com/index.php/PreparedSQLStatement</SourceLine>
   <SourceLine>break</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// var arsSQL() as String</SourceLine>
   <SourceLine>// arsSQL.Add(t_Table.BaseSQL(true))</SourceLine>
   <SourceLine>// arsSQL.Add("WHERE %unique_field% = ?")</SourceLine>
   <SourceLine>// arsSQL.Add("AND %primary_key% &lt;&gt; ?")</SourceLine>
   <SourceLine>// </SourceLine>
   <SourceLine>// var sSQL as String = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine>// </SourceLine>
   <SourceLine>// var rs as RowSet = DataFile.DB.SelectSQL(sSQL, sValue, self.ID)</SourceLine>
   <SourceLine>// return (rs.Column("iCount").IntegerValue &gt; 0)</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>sValue as String</ItemParams>
  <ItemResult>Boolean</ItemResult>
 </Method>
 <Method>
  <ItemName>List</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1339168767</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function List(stmt as PreparedSQLStatement) As DataFile.ActiveRecordClass()</SourceLine>
   <SourceLine>// Take a PreparedStatement that returns data from this table</SourceLine>
   <SourceLine>// and cast it to the ActiveRecord class for use</SourceLine>
   <SourceLine>var rs as RowSet = stmt.SelectSQL</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var aroRecords() as DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>while not rs.AfterLastRow</SourceLine>
   <SourceLine>var oRecord as new DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>oRecord.ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>aroRecords.Add(oRecord)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>wend</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return aroRecords</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>stmt as PreparedSQLStatement</ItemParams>
  <ItemResult>DataFile.ActiveRecordClass()</ItemResult>
 </Method>
 <Method>
  <ItemName>List</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>651698175</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function List(sCriteria as String = "", sOrder as String = "", iOffset as Integer = -1) As DataFile.ActiveRecordClass()</SourceLine>
   <SourceLine>// SQL Injection Note:</SourceLine>
   <SourceLine>//   You should not use this method if your query contains user entered data.</SourceLine>
   <SourceLine>//   Using this method with user entered data could expose you to SQL injection attacks.</SourceLine>
   <SourceLine>var arsSQL() as String</SourceLine>
   <SourceLine>var sBase as String = DataFile.ActiveRecordClass.BaseSQL</SourceLine>
   <SourceLine>arsSQL.Add(sBase)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Criteria</SourceLine>
   <SourceLine>if sCriteria.Trim &lt;&gt; "" then</SourceLine>
   <SourceLine>arsSQL.Add("WHERE " + sCriteria)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// ORDER BY</SourceLine>
   <SourceLine>if sOrder.Trim = "" then</SourceLine>
   <SourceLine>// Set up a default order by</SourceLine>
   <SourceLine>// arsSQL.Add("ORDER BY {default_orderby_field}")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>// Order by parameter passed</SourceLine>
   <SourceLine>arsSQL.Add("ORDER BY " + sOrder)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Offset</SourceLine>
   <SourceLine>if iOffset &gt; -1 then</SourceLine>
   <SourceLine>arsSQL.Add("LIMIT " + str(DataFile.kMaxReturn) + " OFFSET " + str(iOffset))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Fetch</SourceLine>
   <SourceLine>var sSQL as string = String.FromArray(arsSQL)</SourceLine>
   <SourceLine>var rs as RowSet = DataFile.DB.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var aroRecords() as DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>while not rs.AfterLastRow</SourceLine>
   <SourceLine>var oRecord as new DataFile.ActiveRecordClass</SourceLine>
   <SourceLine>oRecord.ReadRecord(rs)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>aroRecords.Add(oRecord)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>rs.MoveToNextRow</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>wend</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return aroRecords</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>sCriteria as String = "", sOrder as String = "", iOffset as Integer = -1</ItemParams>
  <ItemResult>DataFile.ActiveRecordClass()</ItemResult>
 </Method>
 <Method>
  <ItemName>ListCount</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>231581695</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function ListCount(stmt as PreparedSQLStatement) As Integer</SourceLine>
   <SourceLine>// Take a PreparedStatement that returns the count from this table</SourceLine>
   <SourceLine>var rs as RowSet = stmt.SelectSQL</SourceLine>
   <SourceLine>return rs.ColumnAt(0).IntegerValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>stmt as PreparedSQLStatement</ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <Method>
  <ItemName>ListCount</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1558134783</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function ListCount(sCriteria as String = "") As Integer</SourceLine>
   <SourceLine>// SQL Injection Note:</SourceLine>
   <SourceLine>//   You should not use this method if your query contains user entered data.</SourceLine>
   <SourceLine>//   Using this method with user entered data could expose you to SQL injection attacks.</SourceLine>
   <SourceLine>var arsSQL() as String</SourceLine>
   <SourceLine>arsSQL.Add(DataFile.ActiveRecordClass.BaseSQL(true))</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Criteria</SourceLine>
   <SourceLine>if sCriteria.Trim &lt;&gt; "" then</SourceLine>
   <SourceLine>arsSQL.Add("WHERE " + sCriteria)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// Fetch</SourceLine>
   <SourceLine>var sSQL as string = String.FromArray(arsSQL)</SourceLine>
   <SourceLine>var rs as RowSet = DataFile.DB.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs.Column("iCount").IntegerValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>sCriteria as String = ""</ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="131753769">
 <ObjName>ActiveRecordBase</ObjName>
 <ObjContainerID>471158405</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.Base</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="1985282210">
 <ObjName>ActiveRecordView</ObjName>
 <ObjContainerID>471158405</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.View</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Folder" ID="2004107263">
 <ObjName>Extras</ObjName>
 <ObjContainerID>0</ObjContainerID>
</block>
<block type="Module" ID="2019680067">
 <ObjName>TP_DBUpdates</ObjName>
 <ObjContainerID>2004107263</ObjContainerID>
 <IsClass>0</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>CreateVersionTable</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>76351487</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CreateVersionTable(toLocalDB as Database)</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa CubeSQLVM then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateVersionTableSQLite)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer = true then</SourceLine>
   <SourceLine>if toLocalDB isa MSSQLServerDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateVersionTableMSSQL)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer = true then</SourceLine>
   <SourceLine>if toLocalDB isa MySQLCommunityServer then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("START TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateVersionTableMySQL)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC = true then</SourceLine>
   <SourceLine>#pragma Error "TP_AuditTrail does not support ODBC connections."</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("START TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateVersionTablePostgres)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa SQLiteDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateVersionTableSQLite)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch ex as DatabaseException</SourceLine>
   <SourceLine>toLocalDB.RollbackTransaction</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>GetDBVersion</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>190246911</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetDBVersion(toLocalDB as Database) As Integer</SourceLine>
   <SourceLine>var sSQL as String = "SELECT Max(dbversionnumber) AS CurrentVersionCode FROM t_tp_dbversion"</SourceLine>
   <SourceLine>var rs as RowSet = toLocalDB.SelectSQL(sSQL)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return rs.Column("CurrentVersionCode").IntegerValue</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database</ItemParams>
  <ItemResult>Integer</ItemResult>
 </Method>
 <Method>
  <ItemName>SetDBVersion</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>514990079</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub SetDBVersion(toLocalDB as Database, iVersion as Integer)</SourceLine>
   <SourceLine>var sSQL as String = "INSERT INTO t_tp_dbversion(dbversionnumber) VALUES (" + Format(iVersion, "#########") + ");"</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(sSQL)</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database, iVersion as Integer</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>UpdateDB</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1501908991</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub UpdateDB(toLocalDB as Database)</SourceLine>
   <SourceLine>// Create the version table if necessary</SourceLine>
   <SourceLine>CreateVersionTable(toLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var iDBVersion as Integer = GetDBVersion(toLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// If the version is current we're done</SourceLine>
   <SourceLine>if iDBVersion &gt;= kDBVersion then return</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>toLocalDB.BeginTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>// This example is the base for how this update function works</SourceLine>
   <SourceLine>// Repeat this if block for each version. We recommend using</SourceLine>
   <SourceLine>// a different method for each version update, this will help</SourceLine>
   <SourceLine>// keep your code clean and organized.</SourceLine>
   <SourceLine>if iDBVersion &lt; 1 then UpdateVersion_001(toLocalDB)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// After checking for updates, set the current version</SourceLine>
   <SourceLine>SetDBVersion(toLocalDB, kDBVersion)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch ex as DatabaseException</SourceLine>
   <SourceLine>toLocalDB.RollbackTransaction</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>UpdateVersion_001</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>382011391</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub UpdateVersion_001(toLocalDB as Database)</SourceLine>
   <SourceLine>// This is an example function for updating the database</SourceLine>
   <SourceLine>// Use it as a template for updates to the database</SourceLine>
   <SourceLine>#pragma unused toLocalDB</SourceLine>
   <SourceLine>// toLocalDB.ExecuteSQL("{SQL Statement}")</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kCreateVersionTableMSSQL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1528080383</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="484">4946204E4F54204558495354530A20202028202053454C454354205B6E616D655D200A20202020202046524F4D207379732E7461626C65730A2020202020205748455245205B6E616D655D203D2027745F74705F646276657273696F6E27200A202020290A435245415445205441424C45205B745F74705F646276657273696F6E5D280A095B646276657273696F6E5F69645D205B696E745D204944454E5449545928312C3129204E4F54204E554C4C2C0A095B64626461746574696D655D205B6461746574696D655D204E554C4C2044454641554C54204745544441544528292C0A095B646276657273696F6E6E756D6265725D205B696E745D204E554C4C2C0A20434F4E53545241494E54205B504B5F745F74705F646276657273696F6E5D205052494D415259204B455920434C55535445524544200A280A095B646276657273696F6E5F69645D204153430A295749544820285041445F494E444558203D204F46462C20535441544953544943535F4E4F5245434F4D50555445203D204F46462C2049474E4F52455F4455505F4B4559203D204F46462C20414C4C4F575F524F575F4C4F434B53203D204F4E2C20414C4C4F575F504147455F4C4F434B53203D204F4E29204F4E205B5052494D4152595D0A29204F4E205B5052494D4152595D3B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateVersionTableMySQL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>924078079</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="282">435245415445205441424C45204946204E4F542045584953545320745F74705F646276657273696F6E20280A2020646276657273696F6E5F696420696E7428313129204E4F54204E554C4C204155544F5F494E4352454D454E542C0A202064626461746574696D652074696D657374616D70204E4F54204E554C4C2044454641554C542043555252454E545F54494D455354414D502C0A2020646276657273696F6E6E756D62657220696E7428313129204E4F54204E554C4C2044454641554C5420302C0A20205052494D415259204B45592028646276657273696F6E5F6964290A2920454E47494E453D496E6E6F4442204155544F5F494E4352454D454E543D312044454641554C5420434841525345543D6C6174696E313B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateVersionTablePostgres</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>547391487</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="289">4352454154452053455155454E4345202074705F64627570646174655F73657175656E636520535441525420313B0A435245415445205441424C45204946204E4F542045584953545320745F74705F646276657273696F6E0A280A2020646276657273696F6E5F696420626967696E74204E4F54204E554C4C2044454641554C54206E65787476616C282774705F64627570646174655F73657175656E6365273A3A726567636C617373292C0A2020646276657273696F6E6E756D62657220696E74656765722C0A202064626461746574696D6520646174652044454641554C54206E6F7728292C0A2020434F4E53545241494E5420646276657273696F6E5F6964205052494D415259204B45592028646276657273696F6E5F6964290A293B20</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateVersionTableSQLite</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1583452159</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="182">435245415445205441424C45204946204E4F54204558495354532020745F74705F646276657273696F6E20280A0920646276657273696F6E5F696420494E5445474552204E4F54204E554C4C205052494D415259204B4559204155544F494E4352454D454E542C0A092064626461746574696D652054494D455354414D502044454641554C542043555252454E545F54494D455354414D502C0A0920646276657273696F6E6E756D62657220494E54454745520A293B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kDBVersion</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>810858495</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>2</ItemType>
  <ItemDef>1</ItemDef>
  <ItemFlags>1</ItemFlags>
 </Constant>
</block>
<block type="Module" ID="73786099">
 <ObjName>TP_AuditTrail</ObjName>
 <ObjContainerID>2004107263</ObjContainerID>
 <IsClass>0</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>CloneDictionary</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>940611583</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function CloneDictionary(tdictSource as Dictionary) As Dictionary</SourceLine>
   <SourceLine>// Namespaced dictionary clone function</SourceLine>
   <SourceLine>var tdictNew as new Dictionary</SourceLine>
   <SourceLine>if tdictSource = nil then return tdictNew</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>for ti as Integer = (tdictSource.KeyCount - 1) downto 0</SourceLine>
   <SourceLine>// Clone the entry</SourceLine>
   <SourceLine>var tvKey as Variant = tdictSource.Key(ti)</SourceLine>
   <SourceLine>tdictNew.Value(tvKey) = tdictSource.Value(tvKey)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next ti</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return tdictNew</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>tdictSource as Dictionary</ItemParams>
  <ItemResult>Dictionary</ItemResult>
 </Method>
 <Method>
  <ItemName>CreateAuditTables</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2115583999</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CreateAuditTables(toLocalDB as Database)</SourceLine>
   <SourceLine>try</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseCubeDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa CubeSQLVM then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateAuditTablesSQLite)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServer = true then</SourceLine>
   <SourceLine>if toLocalDB isa MSSQLServerDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateAuditTablesMSSQL)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMySQLCommunityServer = true then</SourceLine>
   <SourceLine>if toLocalDB isa MySQLCommunityServer then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("START TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateAuditTablesMySQL)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseODBC = true then</SourceLine>
   <SourceLine>#pragma Error "TP_AuditTrail does not support ODBC connections."</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUsePostgreSQLDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa PostgreSQLDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("START TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateAuditTablesPostgres)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseSQLiteDatabase = true then</SourceLine>
   <SourceLine>if toLocalDB isa SQLiteDatabase then</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL("BEGIN TRANSACTION")</SourceLine>
   <SourceLine>toLocalDB.ExecuteSQL(kCreateAuditTablesSQLite)</SourceLine>
   <SourceLine>toLocalDB.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>catch ex as DatabaseException</SourceLine>
   <SourceLine>toLocalDB.RollbackTransaction</SourceLine>
   <SourceLine>raise ex</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end try</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>toLocalDB as Database</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kCreateAuditTablesMSSQL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>516278271</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="1091">4946204E4F54204558495354530A20202028202053454C454354205B6E616D655D200A20202020202046524F4D207379732E7461626C65730A2020202020205748455245205B6E616D655D203D2027745F74705F617564697427200A202020290A435245415445205441424C45205B745F74705F61756469745D280A095B61756469745F69645D205B696E745D204944454E5449545928312C3129204E4F54204E554C4C2C0A095B7265636F72645F69645D205B696E745D204E554C4C2C0A095B706172656E745F69645D205B696E745D204E554C4C2C0A2020095B7265636F72647461626C655D206E54657874204E554C4C2C0A2020095B7265636F7264616374696F6E5D206E54657874204E554C4C2C0A095B616374696F6E646174655D205B6461746574696D655D204E554C4C2C0A2020095B757365725F69645D205B696E745D204E554C4C2C0A2020095B7265636F72646E6F5D206E54657874204E554C4C2C0A090A20434F4E53545241494E54205B504B5F745F74705F61756469745D205052494D415259204B455920434C55535445524544200A280A095B61756469745F69645D204153430A295749544820285041445F494E444558203D204F46462C20535441544953544943535F4E4F5245434F4D50555445203D204F46462C2049474E4F52455F4455505F4B4559203D204F46462C20414C4C4F575F524F575F4C4F434B53203D204F4E2C20414C4C4F575F504147455F4C4F434B53203D204F4E29204F4E205B5052494D4152595D0A29204F4E205B5052494D4152595D3B0A4946204E4F54204558495354530A20202028202053454C454354205B6E616D655D200A20202020202046524F4D207379732E7461626C65730A2020202020205748455245205B6E616D655D203D2027745F74705F6368616E67656C6F6727200A202020290A435245415445205441424C45205B745F74705F6368616E67656C6F675D280A095B6368616E67656C6F675F69645D205B696E745D204944454E5449545928312C3129204E4F54204E554C4C2C0A095B61756469745F69645D205B696E745D20204E4F54204E554C4C2C0A2020095B6669656C646E616D655D206E54657874204E554C4C2C0A2020095B6F6C6476616C75655D206E54657874204E554C4C2C0A2020095B6E657776616C75655D206E54657874204E554C4C2C090A20434F4E53545241494E54205B504B5F745F74705F6368616E67656C6F675D205052494D415259204B455920434C55535445524544200A280A095B6368616E67656C6F675F69645D204153430A295749544820285041445F494E444558203D204F46462C20535441544953544943535F4E4F5245434F4D50555445203D204F46462C2049474E4F52455F4455505F4B4559203D204F46462C20414C4C4F575F524F575F4C4F434B53203D204F4E2C20414C4C4F575F504147455F4C4F434B53203D204F4E29204F4E205B5052494D4152595D0A29204F4E205B5052494D4152595D3B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateAuditTablesMySQL</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>121190399</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="622">435245415445205441424C45204946204E4F542045584953545320745F74705F617564697420280A202061756469745F696420696E7428313129204E4F54204E554C4C204155544F5F494E4352454D454E542C0A20207265636F72645F696420696E74283131292044454641554C54204E554C4C2C0A2020706172656E745F696420696E74283131292044454641554C54204E554C4C2C0A20207265636F72647461626C6520746578742C0A20207265636F7264616374696F6E20746578742C0A2020616374696F6E64617465206461746574696D652044454641554C54204E554C4C2C0A2020757365725F696420696E74283131292044454641554C54204E554C4C2C0A20207265636F72646E6F20746578742C0A20205052494D415259204B4559202861756469745F6964290A2920454E47494E453D496E6E6F4442204155544F5F494E4352454D454E543D312044454641554C5420434841525345543D6C6174696E313B0A435245415445205441424C45204946204E4F542045584953545320745F74705F6368616E67656C6F6720280A20206368616E67656C6F675F696420696E7428313129204E4F54204E554C4C204155544F5F494E4352454D454E542C0A202061756469745F696420696E74283131292044454641554C54204E554C4C2C0A20206669656C646E616D6520746578742C0A20206F6C6476616C756520746578742C0A20206E657776616C756520746578742C0A20205052494D415259204B455920286368616E67656C6F675F6964290A2920454E47494E453D496E6E6F4442204155544F5F494E4352454D454E543D312044454641554C5420434841525345543D6C6174696E313B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateAuditTablesPostgres</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>904904703</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="760">4352454154452053455155454E4345204946204E4F54204558495354532074705F61756469745F73657175656E6365205354415254205749544820313B0A435245415445205441424C45204946204E4F542045584953545320745F74705F61756469740A280A202061756469745F696420626967696E74204E4F54204E554C4C2044454641554C54206E65787476616C282774705F61756469745F73657175656E6365273A3A726567636C617373292C0A20207265636F72645F696420494E54454745522044454641554C54204E554C4C2C0A2020706172656E745F696420494E54454745522044454641554C54204E554C4C2C0A20207265636F72647461626C6520746578742C0A20207265636F7264616374696F6E20746578742C20200A2020616374696F6E646174652064617465202044454641554C54204E554C4C2C0A2020757365725F696420494E54454745522044454641554C54204E554C4C2C0A20207265636F72646E6F20746578742C2020200A2020434F4E53545241494E542061756469745F6964205052494D415259204B4559202861756469745F6964290A293B0A4352454154452053455155454E4345204946204E4F54204558495354532074705F6368616E67656C6F675F73657175656E6365205354415254205749544820313B0A435245415445205441424C45204946204E4F542045584953545320745F74705F6368616E67656C6F670A280A20206368616E67656C6F675F696420626967696E74204E4F54204E554C4C2044454641554C54206E65787476616C282774705F6368616E67656C6F675F73657175656E6365273A3A726567636C617373292C0A202061756469745F696420494E54454745522044454641554C54204E554C4C2C0A20206669656C646E616D6520746578742C2020200A20206F6C6476616C756520746578742C0A20206E657776616C756520746578742C2020200A2020434F4E53545241494E54206368616E67656C6F675F6964205052494D415259204B455920286368616E67656C6F675F6964290A293B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kCreateAuditTablesSQLite</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1727479807</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="428">435245415445205441424C45204946204E4F542045584953545320745F74705F617564697420280A202061756469745F696420494E5445474552204E4F54204E554C4C205052494D415259204B4559204155544F494E4352454D454E542C0A20207265636F72645F696420494E54454745522C0A2020706172656E745F696420494E54454745522C0A20207265636F72647461626C6520746578742C0A20207265636F7264616374696F6E20746578742C0A2020616374696F6E64617465206461746574696D652044454641554C54204E554C4C2C0A2020757365725F696420494E54454745522C0A20207265636F72646E6F20746578740A293B0A435245415445205441424C45204946204E4F542045584953545320745F74705F6368616E67656C6F6720280A20206368616E67656C6F675F696420494E5445474552204E4F54204E554C4C205052494D415259204B4559204155544F494E4352454D454E542C0A202061756469745F696420494E54454745522C0A20206669656C646E616D6520746578742C0A20206F6C6476616C756520746578742C0A20206E657776616C756520746578740A293B</Hex></ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
</block>
<block type="Module" ID="728335528">
 <ObjName>ChangeLog</ObjName>
 <ObjContainerID>73786099</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Property>
  <ItemName>iaudit_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2018197503</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iaudit_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iaudit_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>ichangelog_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1531537407</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>ichangelog_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>ichangelog_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>sfieldname</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1079042047</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>sfieldname As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>sfieldname As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>snewvalue</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1523208191</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>snewvalue As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>snewvalue As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>soldvalue</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>358565887</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>soldvalue As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>soldvalue As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iaudit_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>ichangelog_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>sfieldname</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>snewvalue</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>soldvalue</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
 </ViewBehavior>
</block>
<block type="Module" ID="450544066">
 <ObjName>Entry</ObjName>
 <ObjContainerID>73786099</ObjContainerID>
 <IsClass>1</IsClass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>AuditAdd</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1165398015</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function AuditAdd(oRecord as DataFile.ActiveRecordBase) As TP_AuditTrail.Entry</SourceLine>
   <SourceLine>var oAudit as new TP_AuditTrail.Entry</SourceLine>
   <SourceLine>oAudit.m_oRecord = oRecord</SourceLine>
   <SourceLine>oAudit.irecord_id = oAudit.m_oRecord.ID</SourceLine>
   <SourceLine>oAudit.sAction = kAuditAdd</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oAudit</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>oRecord as DataFile.ActiveRecordBase</ItemParams>
  <ItemResult>TP_AuditTrail.Entry</ItemResult>
 </Method>
 <Method>
  <ItemName>AuditDelete</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1315827711</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function AuditDelete(oRecord as DataFile.ActiveRecordBase) As TP_AuditTrail.Entry</SourceLine>
   <SourceLine>var oAudit as new TP_AuditTrail.Entry</SourceLine>
   <SourceLine>oAudit.m_oRecord = oRecord</SourceLine>
   <SourceLine>oAudit.irecord_id = oAudit.m_oRecord.ID</SourceLine>
   <SourceLine>oAudit.sAction = kAuditDelete</SourceLine>
   <SourceLine>return oAudit</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>oRecord as DataFile.ActiveRecordBase</ItemParams>
  <ItemResult>TP_AuditTrail.Entry</ItemResult>
 </Method>
 <Method>
  <ItemName>AuditEdit</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1967497215</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Shared Function AuditEdit(oRecord as DataFile.ActiveRecordBase) As TP_AuditTrail.Entry</SourceLine>
   <SourceLine>var oAudit as new TP_AuditTrail.Entry</SourceLine>
   <SourceLine>oAudit.m_oRecord = oRecord</SourceLine>
   <SourceLine>oAudit.irecord_id = oAudit.m_oRecord.ID</SourceLine>
   <SourceLine>oAudit.sAction = kAuditEdit</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>//Build Change Log</SourceLine>
   <SourceLine>for each oChange as TP_AuditTrail.ChangeLog in oAudit.m_oRecord.BuildChangeLog</SourceLine>
   <SourceLine>var bAddChange as Boolean = true</SourceLine>
   <SourceLine>//Ignore modified date/user fields</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var sField as string = oChange.sFieldName.Lowercase</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if sField.IndexOf("modified") &gt; -1 then</SourceLine>
   <SourceLine>bAddChange = false</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>//Add Change</SourceLine>
   <SourceLine>if bAddChange = true then</SourceLine>
   <SourceLine>var oLog as new TP_AuditTrail.ChangeLog</SourceLine>
   <SourceLine>oLog.sFieldName = oChange.sFieldName</SourceLine>
   <SourceLine>oLog.sOldValue = oChange.sOldValue</SourceLine>
   <SourceLine>oLog.sNewValue = oChange.sNewValue</SourceLine>
   <SourceLine>oAudit.aroChangeLog.Add(oLog)</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>return oAudit</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>1</IsShared>
  <ItemParams>oRecord as DataFile.ActiveRecordBase</ItemParams>
  <ItemResult>TP_AuditTrail.Entry</ItemResult>
 </Method>
 <Method>
  <ItemName>Insert</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>913903615</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Insert()</SourceLine>
   <SourceLine>var oAudit As New DatabaseRow</SourceLine>
   <SourceLine>oAudit.Column("record_id").IntegerValue = irecord_id</SourceLine>
   <SourceLine>oAudit.Column("parent_id").IntegerValue = iparent_id</SourceLine>
   <SourceLine>oAudit.Column("recordtable").StringValue = m_oRecord.GetTableName</SourceLine>
   <SourceLine>oAudit.Column("recordaction").StringValue = saction</SourceLine>
   <SourceLine>oAudit.Column("actiondate").DateTimeValue = DateTime.Now</SourceLine>
   <SourceLine>oAudit.Column("user_id").IntegerValue = iuser_id</SourceLine>
   <SourceLine>oAudit.Column("recordno").StringValue = srecordno</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Insert Record</SourceLine>
   <SourceLine>DataFile.DB.AddRow("t_tp_audit", oAudit)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if saction &lt;&gt; kAuditEdit then Return 'Change log is only needed for edit.</SourceLine>
   <SourceLine>'Get the New Record ID.</SourceLine>
   <SourceLine>var iAuditID as int64</SourceLine>
   <SourceLine>iAuditID = m_oRecord.ID</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Save Children if required</SourceLine>
   <SourceLine>for each oChange as TP_AuditTrail.ChangeLog in aroChangeLog</SourceLine>
   <SourceLine>var oChild As New DatabaseRow</SourceLine>
   <SourceLine>oChild.Column("audit_id").IntegerValue = iAuditID</SourceLine>
   <SourceLine>oChild.Column("fieldname").StringValue = oChange.sfieldname</SourceLine>
   <SourceLine>oChild.Column("oldvalue").StringValue = oChange.soldvalue</SourceLine>
   <SourceLine>oChild.Column("newvalue").StringValue = oChange.snewvalue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'Insert Record</SourceLine>
   <SourceLine>DataFile.DB.AddRow("t_tp_changelog", oChild)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>aroChangeLog()</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>911845375</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>aroChangeLog() As TP_AuditTrail.ChangeLog</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>aroChangeLog() As TP_AuditTrail.ChangeLog</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>dtactiondate</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>300128255</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>dtactiondate As DateTime</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>dtactiondate As DateTime</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>iaudit_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1610608639</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iaudit_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iaudit_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>iparent_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1577332735</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iparent_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iparent_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>irecord_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1045805055</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>irecord_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>irecord_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>iuser_id</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>364773375</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>iuser_id As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>iuser_id As Integer</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_oRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>781932543</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_oRecord As DataFile.ActiveRecordBase</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_oRecord As DataFile.ActiveRecordBase</ItemDeclaration>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>saction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>2064816127</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>saction As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>saction As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>srecordno</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1400655871</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>srecordno As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>srecordno As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>srecordtable</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>66949119</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>srecordtable As String</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>srecordtable As String</ItemDeclaration>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iaudit_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iparent_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>irecord_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>iuser_id</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>saction</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>srecordno</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>srecordtable</ObjName>
   <PropertyGroup>Behavior</PropertyGroup>
   <ItemType>String</ItemType>
   <EditorType>MultiLineEditor</EditorType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kAuditAdd</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1043617791</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>Add</ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kAuditDelete</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>290617343</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>Delete</ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kAuditEdit</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>770156543</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>Edit</ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
 <Constant>
  <ItemName>kAuditVoid</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>305147903</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef>Void</ItemDef>
  <ItemFlags>33</ItemFlags>
 </Constant>
</block>
<block type="Module" ID="1736230911">
 <ObjName>MSSQLServerAdapterMBS</ObjName>
 <ObjContainerID>1972432888</ObjContainerID>
 <IsClass>1</IsClass>
 <Superclass>TP_ActiveRecord.DatabaseAdapter</Superclass>
 <ItemFlags>1</ItemFlags>
 <IsInterface>0</IsInterface>
 <Compatibility></Compatibility>
 <Method>
  <ItemName>BeginTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>982779903</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub BeginTransaction()</SourceLine>
   <SourceLine>// Per Christian "You may not call BeginTransaction method in Xojo.</SourceLine>
   <SourceLine>//                This would execute the "BEGIN TRANSACTION" internally,</SourceLine>
   <SourceLine>//                which conflicts the auto commit as the plugin may start</SourceLine>
   <SourceLine>//                a transaction and that may cause an error for starting a</SourceLine>
   <SourceLine>//                transaction within a transaction."</SourceLine>
   <SourceLine>// https://mbs-plugins.de/archive/2020-01-19/Transactions_in_MBS_Xojo_SQL_P/monkeybreadsoftware_blog_xojo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>// So, we do nothing</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt + 1</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>CommitTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>776142847</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub CommitTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Db.CommitTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Constructor</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>896411647</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub Constructor(oDb as Object)</SourceLine>
   <SourceLine>// If you are not connecting to MS SQL Server</SourceLine>
   <SourceLine>// and do not have the MBS SQL Plugin</SourceLine>
   <SourceLine>// then you can safely delete this class</SourceLine>
   <SourceLine>#if TP_ActiveRecord.kConfigUseMSSQLServerMBS then</SourceLine>
   <SourceLine>var db as SQLDatabaseMBS = SQLDatabaseMBS(oDb)</SourceLine>
   <SourceLine>if db=nil then</SourceLine>
   <SourceLine>raise new RuntimeException</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>m_db = db</SourceLine>
   <SourceLine>#else</SourceLine>
   <SourceLine>#pragma unused oDB</SourceLine>
   <SourceLine>raise new UnsupportedOperationException</SourceLine>
   <SourceLine>#endif</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oDb as Object</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>Db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>914810879</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function Db() As Database</SourceLine>
   <SourceLine>return m_db</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Database</ItemResult>
 </Method>
 <Method>
  <ItemName>GetLastInsertID</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>990033919</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Function GetLastInsertID() As Int64</SourceLine>
   <SourceLine>var rs as RowSet</SourceLine>
   <SourceLine>rs = SQLSelect("SELECT @@IDENTITY;")</SourceLine>
   <SourceLine>return rs.ColumnAt(0).Int64Value</SourceLine>
   <SourceLine>End Function</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>1</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult>Int64</ItemResult>
 </Method>
 <Method>
  <ItemName>InsertRecord</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>1019037695</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub InsertRecord(oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary)</SourceLine>
   <SourceLine>var oTableInfo as TP_ActiveRecord.P.TableInfo</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var dictFieldValue as Dictionary</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>oTableInfo = GetTableInfo( Introspection.GetType(oRecord) )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var arsField() as string</SourceLine>
   <SourceLine>var arsPlaceholder() as string</SourceLine>
   <SourceLine>var aroField() as TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>var sPK as string</SourceLine>
   <SourceLine>var oPKField as  TP_ActiveRecord.P.FieldInfo</SourceLine>
   <SourceLine>for each oField as TP_ActiveRecord.P.FieldInfo in oTableInfo.aroField</SourceLine>
   <SourceLine>if oField.bPrimaryKey then</SourceLine>
   <SourceLine>sPK = oField.sFieldName</SourceLine>
   <SourceLine>oPKField = oField</SourceLine>
   <SourceLine>continue</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>arsField.Add(oField.sFieldName)</SourceLine>
   <SourceLine>arsPlaceholder.Add("?")</SourceLine>
   <SourceLine>aroField.Add(oField)</SourceLine>
   <SourceLine>next</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var arsSQL() as string</SourceLine>
   <SourceLine>arsSQL.Add("INSERT INTO " + oTableInfo.sTableName)</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsField, ",") + ")")</SourceLine>
   <SourceLine>arssql.Add("OUTPUT inserted." + sPK)</SourceLine>
   <SourceLine>arsSQL.Add(" VALUES ")</SourceLine>
   <SourceLine>arsSQL.Add("(" + String.FromArray(arsPlaceholder, ",") + ")")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var sSQL as string = String.FromArray(arsSQL, " ")</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var stmt as PreparedSQLStatement</SourceLine>
   <SourceLine>stmt = db.Prepare( sSQL )</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>Var aroValues() As Variant</SourceLine>
   <SourceLine>dictFieldValue = BindValues(oRecord, aroField, aroValues)</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>var rs as Rowset = stmt.SelectSQL</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>if oPKField.piFieldProperty.PropertyType.Name = "String" then</SourceLine>
   <SourceLine>var sRecordID as string = rs.Column(sPK).StringValue</SourceLine>
   <SourceLine>sRecordID = sRecordID.ReplaceAll("{", "")</SourceLine>
   <SourceLine>sRecordID = sRecordID.ReplaceAll("}", "")</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = sRecordID</SourceLine>
   <SourceLine>oRecord.GUID = sRecordID</SourceLine>
   <SourceLine>else</SourceLine>
   <SourceLine>var iRecordID as Int64 = rs.Column(sPK).Int64Value</SourceLine>
   <SourceLine>dictFieldValue.Value( oTableInfo.piPrimaryKey.Name ) = iRecordID</SourceLine>
   <SourceLine>oRecord.id = iRecordID</SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>'store the newly saved property values</SourceLine>
   <SourceLine>dictSavedPropertyValue = dictFieldValue</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams>oRecord as TP_ActiveRecord.Base, byref dictSavedPropertyValue as Dictionary</ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Method>
  <ItemName>RollbackTransaction</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>702627839</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>Sub RollbackTransaction()</SourceLine>
   <SourceLine>m_iTransactionCt = m_iTransactionCt - 1</SourceLine>
   <SourceLine>if m_iTransactionCt=0 then</SourceLine>
   <SourceLine>Db.RollbackTransaction</SourceLine>
   <SourceLine></SourceLine>
   <SourceLine>end if</SourceLine>
   <SourceLine>End Sub</SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <AliasName></AliasName>
  <ItemFlags>0</ItemFlags>
  <IsShared>0</IsShared>
  <ItemParams></ItemParams>
  <ItemResult></ItemResult>
 </Method>
 <Property>
  <ItemName>m_db</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>642838527</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_db As Database</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_db As Database</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <Property>
  <ItemName>m_iTransactionCt</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>200245247</PartID>
  <ItemSource>
   <TextEncoding>134217984</TextEncoding>
   <SourceLine>m_iTransactionCt As Integer</SourceLine>
   <SourceLine></SourceLine>
  </ItemSource>
  <TextEncoding>134217984</TextEncoding>
  <ItemDeclaration>m_iTransactionCt As Integer</ItemDeclaration>
  <ItemFlags>33</ItemFlags>
  <IsShared>0</IsShared>
 </Property>
 <ViewBehavior>
  <ViewProperty>
   <ObjName>Index</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <PropertyValue>-2147483648</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Left</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Name</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Super</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>ID</PropertyGroup>
   <ItemType>String</ItemType>
  </ViewProperty>
  <ViewProperty>
   <ObjName>Top</ObjName>
   <Visible>1</Visible>
   <PropertyGroup>Position</PropertyGroup>
   <PropertyValue>0</PropertyValue>
   <ItemType>Integer</ItemType>
  </ViewProperty>
 </ViewBehavior>
 <Constant>
  <ItemName>kFieldSchema</ItemName>
  <Compatibility></Compatibility>
  <Visible>1</Visible>
  <PartID>865994751</PartID>
  <TextEncoding>134217984</TextEncoding>
  <ItemType>0</ItemType>
  <ItemDef><Hex bytes="1430">53454C45435420434F4C554D4E5F4E414D4520417320436F6C756D6E4E616D652C0A4341534520444154415F545950450A20202020205748454E206E756C6C205448454E20300A20202020205748454E202774696E79696E7427205448454E20310A20202020205748454E2027736D616C6C696E7427205448454E20320A20202020205748454E2027696E7427205448454E20330A20202020205748454E20276368617227205448454E20350A20202020205748454E20277661726368617227205448454E20350A20202020205748454E20277661726368617227205448454E20350A20202020205748454E20277465787427205448454E20350A20202020205748454E20276E6368617227205448454E20350A20202020205748454E20276E7661726368617227205448454E20350A20202020205748454E20276E7465787427205448454E20350A20202020205748454E2027666C6F617427205448454E20360A20202020205748454E20277265616C27205448454E20370A20202020205748454E20276461746527205448454E20380A20202020205748454E202774696D6527205448454E20390A20202020205748454E20276461746574696D6527205448454E2031300A20202020205748454E20276461746574696D653227205448454E2031300A20202020205748454E202774696D657374616D7027205448454E2031300A20202020205748454E20276D6F6E657927205448454E2031310A20202020205748454E2027736D616C6C6D6F6E657927205448454E2031310A20202020205748454E202762697427205448454E2031320A20202020205748454E2027646563696D616C27205448454E2031330A20202020205748454E202762696E61727927205448454E2031340A20202020205748454E2027696D61676527205448454E2031340A20202020205748454E202776617262696E61727927205448454E2031350A20202020205748454E2027626967696E7427205448454E2031390A2020202020454C5345203235350A454E44204173204669656C64547970652C200A280A20202053454C45435420434F554E54282A290A202020202046524F4D207379732E696E6465785F636F6C756D6E732C207379732E696E64657865730A202020205748455245200A202020202020202020207379732E696E6465785F636F6C756D6E732E6F626A6563745F6964203D204F626A6563745F4964283F290A202020202020414E44207379732E696E6465785F636F6C756D6E732E696E6465785F6964203D202853454C4543542044495354494E435420696E6465785F69642046524F4D207379732E696E6465786573205748455245207379732E696E64657865732E6F626A6563745F6964203D204F626A6563745F4964283F2920414E442069735F7072696D6172795F6B6579203D2031290A202020202020414E44207379732E696E64657865732E6F626A6563745F6964203D207379732E696E6465785F636F6C756D6E732E6F626A6563745F69640A202020202020414E44207379732E696E64657865732E696E6465785F6964203D207379732E696E6465785F636F6C756D6E732E696E6465785F69640A202020202020414E44207379732E696E6465785F636F6C756D6E732E696E6465785F636F6C756D6E5F6964203D20434F4C554D4E532E4F5244494E414C5F504F534954494F4E0A292041532049735072696D6172792C0A4949462849535F4E554C4C41424C45203D2027594553272C312C3029206173204E6F744E756C6C2C0A49734E756C6C284348415241435445525F4D4158494D554D5F4C454E4754482C3029204153204C656E677468200A46524F4D20494E464F524D4154494F4E5F534348454D412E434F4C554D4E5320415320434F4C554D4E530A5748455245205441424C455F4E414D45204C494B45203F0A4F52444552204259204F5244494E414C5F504F534954494F4E</Hex></ItemDef>
  <ItemFlags>0</ItemFlags>
 </Constant>
</block>
</RBProject>
